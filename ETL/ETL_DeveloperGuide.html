<!doctype html>
<html>
    <head>
        <title>ETL_DeveloperGuide</title>
        <meta charset='utf-8'/>
        <style>
 .ͼ1.cm-focused {outline: 1px dotted #212121;}
.ͼ1 {position: relative !important; box-sizing: border-box; display: flex !important; flex-direction: column;}
.ͼ1 .cm-scroller {display: flex !important; align-items: flex-start !important; font-family: monospace; line-height: 1.4; height: 100%; overflow-x: auto; position: relative; z-index: 0; overflow-anchor: none;}
.ͼ1 .cm-content[contenteditable=true] {-webkit-user-modify: read-write-plaintext-only;}
.ͼ1 .cm-content {margin: 0; flex-grow: 2; flex-shrink: 0; display: block; white-space: pre; word-wrap: normal; box-sizing: border-box; min-height: 100%; padding: 4px 0; outline: none;}
.ͼ1 .cm-lineWrapping {white-space: pre-wrap; white-space: break-spaces; word-break: break-word; overflow-wrap: anywhere; flex-shrink: 1;}
.ͼ2 .cm-content {caret-color: black;}
.ͼ3 .cm-content {caret-color: white;}
.ͼ1 .cm-line {display: block; padding: 0 2px 0 6px;}
.ͼ1 .cm-layer > * {position: absolute;}
.ͼ1 .cm-layer {position: absolute; left: 0; top: 0; contain: size style;}
.ͼ2 .cm-selectionBackground {background: #d9d9d9;}
.ͼ3 .cm-selectionBackground {background: #222;}
.ͼ2.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground {background: #d7d4f0;}
.ͼ3.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground {background: #233;}
.ͼ1 .cm-cursorLayer {pointer-events: none;}
.ͼ1.cm-focused > .cm-scroller > .cm-cursorLayer {animation: steps(1) cm-blink 1.2s infinite;}
@keyframes cm-blink {50% {opacity: 0;}}
@keyframes cm-blink2 {50% {opacity: 0;}}
.ͼ1 .cm-cursor, .ͼ1 .cm-dropCursor {border-left: 1.2px solid black; margin-left: -0.6px; pointer-events: none;}
.ͼ1 .cm-cursor {display: none;}
.ͼ3 .cm-cursor {border-left-color: #ddd;}
.ͼ1 .cm-dropCursor {position: absolute;}
.ͼ1.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor {display: block;}
.ͼ1 .cm-iso {unicode-bidi: isolate;}
.ͼ1 .cm-announced {position: fixed; top: -10000px;}
@media print {.ͼ1 .cm-announced {display: none;}}
.ͼ2 .cm-activeLine {background-color: #cceeff44;}
.ͼ3 .cm-activeLine {background-color: #99eeff33;}
.ͼ2 .cm-specialChar {color: red;}
.ͼ3 .cm-specialChar {color: #f78;}
.ͼ1 .cm-gutters {flex-shrink: 0; display: flex; height: 100%; box-sizing: border-box; z-index: 200;}
.ͼ1 .cm-gutters-before {inset-inline-start: 0;}
.ͼ1 .cm-gutters-after {inset-inline-end: 0;}
.ͼ2 .cm-gutters.cm-gutters-before {border-right-width: 1px;}
.ͼ2 .cm-gutters.cm-gutters-after {border-left-width: 1px;}
.ͼ2 .cm-gutters {background-color: #f5f5f5; color: #6c6c6c; border: 0px solid #ddd;}
.ͼ3 .cm-gutters {background-color: #333338; color: #ccc;}
.ͼ1 .cm-gutter {display: flex !important; flex-direction: column; flex-shrink: 0; box-sizing: border-box; min-height: 100%; overflow: hidden;}
.ͼ1 .cm-gutterElement {box-sizing: border-box;}
.ͼ1 .cm-lineNumbers .cm-gutterElement {padding: 0 3px 0 5px; min-width: 20px; text-align: right; white-space: nowrap;}
.ͼ2 .cm-activeLineGutter {background-color: #e2f2ff;}
.ͼ3 .cm-activeLineGutter {background-color: #222227;}
.ͼ1 .cm-panels {box-sizing: border-box; position: sticky; left: 0; right: 0; z-index: 300;}
.ͼ2 .cm-panels {background-color: #f5f5f5; color: black;}
.ͼ2 .cm-panels-top {border-bottom: 1px solid #ddd;}
.ͼ2 .cm-panels-bottom {border-top: 1px solid #ddd;}
.ͼ3 .cm-panels {background-color: #333338; color: white;}
.ͼ1 .cm-dialog label {font-size: 80%;}
.ͼ1 .cm-dialog {padding: 2px 19px 4px 6px; position: relative;}
.ͼ1 .cm-dialog-close {position: absolute; top: 3px; right: 4px; background-color: inherit; border: none; font: inherit; font-size: 14px; padding: 0;}
.ͼ1 .cm-tab {display: inline-block; overflow: hidden; vertical-align: bottom;}
.ͼ1 .cm-widgetBuffer {vertical-align: text-top; height: 1em; width: 0; display: inline;}
.ͼ1 .cm-placeholder {color: #888; display: inline-block; vertical-align: top; user-select: none;}
.ͼ1 .cm-highlightSpace {background-image: radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%); background-position: center;}
.ͼ1 .cm-highlightTab {background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>'); background-size: auto 100%; background-position: right 90%; background-repeat: no-repeat;}
.ͼ1 .cm-trailingSpace {background-color: #ff332255;}
.ͼ1 .cm-button {vertical-align: middle; color: inherit; font-size: 70%; padding: .2em 1em; border-radius: 1px;}
.ͼ2 .cm-button:active {background-image: linear-gradient(#b4b4b4, #d0d3d6);}
.ͼ2 .cm-button {background-image: linear-gradient(#eff1f5, #d9d9df); border: 1px solid #888;}
.ͼ3 .cm-button:active {background-image: linear-gradient(#111, #333);}
.ͼ3 .cm-button {background-image: linear-gradient(#393939, #111); border: 1px solid #888;}
.ͼ1 .cm-textfield {vertical-align: middle; color: inherit; font-size: 70%; border: 1px solid silver; padding: .2em .5em;}
.ͼ2 .cm-textfield {background-color: white;}
.ͼ3 .cm-textfield {border: 1px solid #555; background-color: inherit;}
.ͼ1 .cm-foldPlaceholder {background-color: #eee; border: 1px solid #ddd; color: #888; border-radius: .2em; margin: 0 1px; padding: 0 1px; cursor: pointer;}
.ͼ1 .cm-foldGutter span {padding: 0 1px; cursor: pointer;}
 /* Sets all the text color to red! */

div.obsidian-local-rest-api-settings div.api-key-display {
  margin-bottom: 20px;
}
div.obsidian-local-rest-api-settings div.api-key-display pre {
  font-size: 0.8em;
  padding: 10px 20px;
  background-color: var(--background-modifier-cover);
  font-family: monospace;
  user-select: all;
}

div.obsidian-local-rest-api-settings div.setting-item-control {
  min-width: 50%;
}

div.obsidian-local-rest-api-settings textarea {
  width: 100%;
}

div.obsidian-local-rest-api-settings div.certificate-expired {
  padding: 10px 20px;
  border: 2px solid #ff0000;
}

div.obsidian-local-rest-api-settings div.certificate-expiring-soon {
  padding: 10px 20px;
  border: 2px solid #ffff00;
}

div.obsidian-local-rest-api-settings div.certificate-regeneration-recommended {
  padding: 10px 20px;
  border: 2px solid #ffff00;
}

div.obsidian-local-rest-api-settings table.api-urls tr {
  width: 100%;
}

div.obsidian-local-rest-api-settings table.api-urls th, div.obsidian-local-rest-api-settings table.api-urls td {
  padding: 5px 25px;
}

div.obsidian-local-rest-api-settings table.api-urls tr.disabled td.name, div.obsidian-local-rest-api-settings table.api-urls tr.disabled td.url {
  text-decoration: line-through;
}
 .setting-item.ex-setting-item{border-top:unset;padding-top:0}*[hidden]{display:none}
 
.pandoc-plugin-error {
    color: red;
}
  #m98ab3cac96250869{font-family:var(--font-mermaid);font-size:16px;fill:#333;}#m98ab3cac96250869 .error-icon{fill:#552222;}#m98ab3cac96250869 .error-text{fill:#552222;stroke:#552222;}#m98ab3cac96250869 .edge-thickness-normal{stroke-width:1px;}#m98ab3cac96250869 .edge-thickness-thick{stroke-width:3.5px;}#m98ab3cac96250869 .edge-pattern-solid{stroke-dasharray:0;}#m98ab3cac96250869 .edge-thickness-invisible{stroke-width:0;fill:none;}#m98ab3cac96250869 .edge-pattern-dashed{stroke-dasharray:3;}#m98ab3cac96250869 .edge-pattern-dotted{stroke-dasharray:2;}#m98ab3cac96250869 .marker{fill:#333333;stroke:#333333;}#m98ab3cac96250869 .marker.cross{stroke:#333333;}#m98ab3cac96250869 svg{font-family:var(--font-mermaid);font-size:16px;}#m98ab3cac96250869 p{margin:0;}#m98ab3cac96250869 .label{font-family:var(--font-mermaid);color:#333;}#m98ab3cac96250869 .cluster-label text{fill:#333;}#m98ab3cac96250869 .cluster-label span{color:#333;}#m98ab3cac96250869 .cluster-label span p{background-color:transparent;}#m98ab3cac96250869 .label text,#m98ab3cac96250869 span{fill:#333;color:#333;}#m98ab3cac96250869 .node rect,#m98ab3cac96250869 .node circle,#m98ab3cac96250869 .node ellipse,#m98ab3cac96250869 .node polygon,#m98ab3cac96250869 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#m98ab3cac96250869 .rough-node .label text,#m98ab3cac96250869 .node .label text,#m98ab3cac96250869 .image-shape .label,#m98ab3cac96250869 .icon-shape .label{text-anchor:middle;}#m98ab3cac96250869 .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#m98ab3cac96250869 .rough-node .label,#m98ab3cac96250869 .node .label,#m98ab3cac96250869 .image-shape .label,#m98ab3cac96250869 .icon-shape .label{text-align:center;}#m98ab3cac96250869 .node.clickable{cursor:pointer;}#m98ab3cac96250869 .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#m98ab3cac96250869 .arrowheadPath{fill:#333333;}#m98ab3cac96250869 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#m98ab3cac96250869 .flowchart-link{stroke:#333333;fill:none;}#m98ab3cac96250869 .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#m98ab3cac96250869 .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#m98ab3cac96250869 .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#m98ab3cac96250869 .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#m98ab3cac96250869 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#m98ab3cac96250869 .cluster text{fill:#333;}#m98ab3cac96250869 .cluster span{color:#333;}#m98ab3cac96250869 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:var(--font-mermaid);font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#m98ab3cac96250869 .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#m98ab3cac96250869 rect.text{fill:none;stroke-width:0;}#m98ab3cac96250869 .icon-shape,#m98ab3cac96250869 .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#m98ab3cac96250869 .icon-shape p,#m98ab3cac96250869 .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#m98ab3cac96250869 .icon-shape rect,#m98ab3cac96250869 .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#m98ab3cac96250869 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;} #m7cfd16bb19b8b904{font-family:var(--font-mermaid);font-size:16px;fill:#333;}#m7cfd16bb19b8b904 .error-icon{fill:#552222;}#m7cfd16bb19b8b904 .error-text{fill:#552222;stroke:#552222;}#m7cfd16bb19b8b904 .edge-thickness-normal{stroke-width:1px;}#m7cfd16bb19b8b904 .edge-thickness-thick{stroke-width:3.5px;}#m7cfd16bb19b8b904 .edge-pattern-solid{stroke-dasharray:0;}#m7cfd16bb19b8b904 .edge-thickness-invisible{stroke-width:0;fill:none;}#m7cfd16bb19b8b904 .edge-pattern-dashed{stroke-dasharray:3;}#m7cfd16bb19b8b904 .edge-pattern-dotted{stroke-dasharray:2;}#m7cfd16bb19b8b904 .marker{fill:#333333;stroke:#333333;}#m7cfd16bb19b8b904 .marker.cross{stroke:#333333;}#m7cfd16bb19b8b904 svg{font-family:var(--font-mermaid);font-size:16px;}#m7cfd16bb19b8b904 p{margin:0;}#m7cfd16bb19b8b904 .label{font-family:var(--font-mermaid);color:#333;}#m7cfd16bb19b8b904 .cluster-label text{fill:#333;}#m7cfd16bb19b8b904 .cluster-label span{color:#333;}#m7cfd16bb19b8b904 .cluster-label span p{background-color:transparent;}#m7cfd16bb19b8b904 .label text,#m7cfd16bb19b8b904 span{fill:#333;color:#333;}#m7cfd16bb19b8b904 .node rect,#m7cfd16bb19b8b904 .node circle,#m7cfd16bb19b8b904 .node ellipse,#m7cfd16bb19b8b904 .node polygon,#m7cfd16bb19b8b904 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#m7cfd16bb19b8b904 .rough-node .label text,#m7cfd16bb19b8b904 .node .label text,#m7cfd16bb19b8b904 .image-shape .label,#m7cfd16bb19b8b904 .icon-shape .label{text-anchor:middle;}#m7cfd16bb19b8b904 .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#m7cfd16bb19b8b904 .rough-node .label,#m7cfd16bb19b8b904 .node .label,#m7cfd16bb19b8b904 .image-shape .label,#m7cfd16bb19b8b904 .icon-shape .label{text-align:center;}#m7cfd16bb19b8b904 .node.clickable{cursor:pointer;}#m7cfd16bb19b8b904 .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#m7cfd16bb19b8b904 .arrowheadPath{fill:#333333;}#m7cfd16bb19b8b904 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#m7cfd16bb19b8b904 .flowchart-link{stroke:#333333;fill:none;}#m7cfd16bb19b8b904 .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#m7cfd16bb19b8b904 .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#m7cfd16bb19b8b904 .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#m7cfd16bb19b8b904 .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#m7cfd16bb19b8b904 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#m7cfd16bb19b8b904 .cluster text{fill:#333;}#m7cfd16bb19b8b904 .cluster span{color:#333;}#m7cfd16bb19b8b904 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:var(--font-mermaid);font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#m7cfd16bb19b8b904 .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#m7cfd16bb19b8b904 rect.text{fill:none;stroke-width:0;}#m7cfd16bb19b8b904 .icon-shape,#m7cfd16bb19b8b904 .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#m7cfd16bb19b8b904 .icon-shape p,#m7cfd16bb19b8b904 .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#m7cfd16bb19b8b904 .icon-shape rect,#m7cfd16bb19b8b904 .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#m7cfd16bb19b8b904 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;} #m19be3081a4908da3{font-family:var(--font-mermaid);font-size:16px;fill:#333;}#m19be3081a4908da3 .error-icon{fill:#552222;}#m19be3081a4908da3 .error-text{fill:#552222;stroke:#552222;}#m19be3081a4908da3 .edge-thickness-normal{stroke-width:1px;}#m19be3081a4908da3 .edge-thickness-thick{stroke-width:3.5px;}#m19be3081a4908da3 .edge-pattern-solid{stroke-dasharray:0;}#m19be3081a4908da3 .edge-thickness-invisible{stroke-width:0;fill:none;}#m19be3081a4908da3 .edge-pattern-dashed{stroke-dasharray:3;}#m19be3081a4908da3 .edge-pattern-dotted{stroke-dasharray:2;}#m19be3081a4908da3 .marker{fill:#333333;stroke:#333333;}#m19be3081a4908da3 .marker.cross{stroke:#333333;}#m19be3081a4908da3 svg{font-family:var(--font-mermaid);font-size:16px;}#m19be3081a4908da3 p{margin:0;}#m19be3081a4908da3 .label{font-family:var(--font-mermaid);color:#333;}#m19be3081a4908da3 .cluster-label text{fill:#333;}#m19be3081a4908da3 .cluster-label span{color:#333;}#m19be3081a4908da3 .cluster-label span p{background-color:transparent;}#m19be3081a4908da3 .label text,#m19be3081a4908da3 span{fill:#333;color:#333;}#m19be3081a4908da3 .node rect,#m19be3081a4908da3 .node circle,#m19be3081a4908da3 .node ellipse,#m19be3081a4908da3 .node polygon,#m19be3081a4908da3 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#m19be3081a4908da3 .rough-node .label text,#m19be3081a4908da3 .node .label text,#m19be3081a4908da3 .image-shape .label,#m19be3081a4908da3 .icon-shape .label{text-anchor:middle;}#m19be3081a4908da3 .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#m19be3081a4908da3 .rough-node .label,#m19be3081a4908da3 .node .label,#m19be3081a4908da3 .image-shape .label,#m19be3081a4908da3 .icon-shape .label{text-align:center;}#m19be3081a4908da3 .node.clickable{cursor:pointer;}#m19be3081a4908da3 .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#m19be3081a4908da3 .arrowheadPath{fill:#333333;}#m19be3081a4908da3 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#m19be3081a4908da3 .flowchart-link{stroke:#333333;fill:none;}#m19be3081a4908da3 .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#m19be3081a4908da3 .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#m19be3081a4908da3 .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#m19be3081a4908da3 .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#m19be3081a4908da3 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#m19be3081a4908da3 .cluster text{fill:#333;}#m19be3081a4908da3 .cluster span{color:#333;}#m19be3081a4908da3 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:var(--font-mermaid);font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#m19be3081a4908da3 .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#m19be3081a4908da3 rect.text{fill:none;stroke-width:0;}#m19be3081a4908da3 .icon-shape,#m19be3081a4908da3 .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#m19be3081a4908da3 .icon-shape p,#m19be3081a4908da3 .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#m19be3081a4908da3 .icon-shape rect,#m19be3081a4908da3 .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#m19be3081a4908da3 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}
:root {
  --default-font: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Microsoft YaHei Light", sans-serif;
  --font-monospace: 'Source Code Pro', monospace;
  --background-primary: #ffffff;
  --background-modifier-border: #ddd;
  --text-accent: #705dcf;
  --text-accent-hover: #7a6ae6;
  --text-normal: #2e3338;
  --background-secondary: #f2f3f5;
  --background-secondary-alt: #e3e5e8;
  --text-muted: #888888;
} #m5254f94fd952d09d{font-family:var(--font-mermaid);font-size:16px;fill:#333;}#m5254f94fd952d09d .error-icon{fill:#552222;}#m5254f94fd952d09d .error-text{fill:#552222;stroke:#552222;}#m5254f94fd952d09d .edge-thickness-normal{stroke-width:1px;}#m5254f94fd952d09d .edge-thickness-thick{stroke-width:3.5px;}#m5254f94fd952d09d .edge-pattern-solid{stroke-dasharray:0;}#m5254f94fd952d09d .edge-thickness-invisible{stroke-width:0;fill:none;}#m5254f94fd952d09d .edge-pattern-dashed{stroke-dasharray:3;}#m5254f94fd952d09d .edge-pattern-dotted{stroke-dasharray:2;}#m5254f94fd952d09d .marker{fill:#333333;stroke:#333333;}#m5254f94fd952d09d .marker.cross{stroke:#333333;}#m5254f94fd952d09d svg{font-family:var(--font-mermaid);font-size:16px;}#m5254f94fd952d09d p{margin:0;}#m5254f94fd952d09d .actor{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;}#m5254f94fd952d09d text.actor&gt;tspan{fill:black;stroke:none;}#m5254f94fd952d09d .actor-line{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);}#m5254f94fd952d09d .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333;}#m5254f94fd952d09d .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333;}#m5254f94fd952d09d #m5254f94fd952d09d-arrowhead path{fill:#333;stroke:#333;}#m5254f94fd952d09d .sequenceNumber{fill:white;}#m5254f94fd952d09d #m5254f94fd952d09d-sequencenumber{fill:#333;}#m5254f94fd952d09d #m5254f94fd952d09d-crosshead path{fill:#333;stroke:#333;}#m5254f94fd952d09d .messageText{fill:#333;stroke:none;}#m5254f94fd952d09d .labelBox{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;}#m5254f94fd952d09d .labelText,#m5254f94fd952d09d .labelText&gt;tspan{fill:black;stroke:none;}#m5254f94fd952d09d .loopText,#m5254f94fd952d09d .loopText&gt;tspan{fill:black;stroke:none;}#m5254f94fd952d09d .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);}#m5254f94fd952d09d .note{stroke:#aaaa33;fill:#fff5ad;}#m5254f94fd952d09d .noteText,#m5254f94fd952d09d .noteText&gt;tspan{fill:black;stroke:none;}#m5254f94fd952d09d .activation0{fill:#f4f4f4;stroke:#666;}#m5254f94fd952d09d .activation1{fill:#f4f4f4;stroke:#666;}#m5254f94fd952d09d .activation2{fill:#f4f4f4;stroke:#666;}#m5254f94fd952d09d .actorPopupMenu{position:absolute;}#m5254f94fd952d09d .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0px 8px 16px 0px rgba(0,0,0,0.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / 0.4));}#m5254f94fd952d09d .actor-man line{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;}#m5254f94fd952d09d .actor-man circle,#m5254f94fd952d09d line{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;stroke-width:2px;}#m5254f94fd952d09d :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;} #mc0eea05d4b9d1ac9{font-family:var(--font-mermaid);font-size:16px;fill:#333;}#mc0eea05d4b9d1ac9 .error-icon{fill:#552222;}#mc0eea05d4b9d1ac9 .error-text{fill:#552222;stroke:#552222;}#mc0eea05d4b9d1ac9 .edge-thickness-normal{stroke-width:1px;}#mc0eea05d4b9d1ac9 .edge-thickness-thick{stroke-width:3.5px;}#mc0eea05d4b9d1ac9 .edge-pattern-solid{stroke-dasharray:0;}#mc0eea05d4b9d1ac9 .edge-thickness-invisible{stroke-width:0;fill:none;}#mc0eea05d4b9d1ac9 .edge-pattern-dashed{stroke-dasharray:3;}#mc0eea05d4b9d1ac9 .edge-pattern-dotted{stroke-dasharray:2;}#mc0eea05d4b9d1ac9 .marker{fill:#333333;stroke:#333333;}#mc0eea05d4b9d1ac9 .marker.cross{stroke:#333333;}#mc0eea05d4b9d1ac9 svg{font-family:var(--font-mermaid);font-size:16px;}#mc0eea05d4b9d1ac9 p{margin:0;}#mc0eea05d4b9d1ac9 .actor{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;}#mc0eea05d4b9d1ac9 text.actor&gt;tspan{fill:black;stroke:none;}#mc0eea05d4b9d1ac9 .actor-line{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);}#mc0eea05d4b9d1ac9 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333;}#mc0eea05d4b9d1ac9 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333;}#mc0eea05d4b9d1ac9 #mc0eea05d4b9d1ac9-arrowhead path{fill:#333;stroke:#333;}#mc0eea05d4b9d1ac9 .sequenceNumber{fill:white;}#mc0eea05d4b9d1ac9 #mc0eea05d4b9d1ac9-sequencenumber{fill:#333;}#mc0eea05d4b9d1ac9 #mc0eea05d4b9d1ac9-crosshead path{fill:#333;stroke:#333;}#mc0eea05d4b9d1ac9 .messageText{fill:#333;stroke:none;}#mc0eea05d4b9d1ac9 .labelBox{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;}#mc0eea05d4b9d1ac9 .labelText,#mc0eea05d4b9d1ac9 .labelText&gt;tspan{fill:black;stroke:none;}#mc0eea05d4b9d1ac9 .loopText,#mc0eea05d4b9d1ac9 .loopText&gt;tspan{fill:black;stroke:none;}#mc0eea05d4b9d1ac9 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);}#mc0eea05d4b9d1ac9 .note{stroke:#aaaa33;fill:#fff5ad;}#mc0eea05d4b9d1ac9 .noteText,#mc0eea05d4b9d1ac9 .noteText&gt;tspan{fill:black;stroke:none;}#mc0eea05d4b9d1ac9 .activation0{fill:#f4f4f4;stroke:#666;}#mc0eea05d4b9d1ac9 .activation1{fill:#f4f4f4;stroke:#666;}#mc0eea05d4b9d1ac9 .activation2{fill:#f4f4f4;stroke:#666;}#mc0eea05d4b9d1ac9 .actorPopupMenu{position:absolute;}#mc0eea05d4b9d1ac9 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0px 8px 16px 0px rgba(0,0,0,0.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / 0.4));}#mc0eea05d4b9d1ac9 .actor-man line{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;}#mc0eea05d4b9d1ac9 .actor-man circle,#mc0eea05d4b9d1ac9 line{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;stroke-width:2px;}#mc0eea05d4b9d1ac9 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}undefined
</style>
    </head>
    <body>
<h1 data-heading="ETL Developer Guide — OMAP_ETL" dir="auto">ETL Developer Guide — OMAP_ETL</h1>
<h2 data-heading="Purpose" dir="auto">Purpose</h2>
<p dir="auto">This document is a developer-focused guide to the OMAP ETL: what it does, how the mapping is represented, the two runtime modes (FastChange and SlowChange), the main files and stored procedures and how to run and debug.</p>
<p dir="auto">The ETL synchronizes data from multiple source schemas/databases into a single unified destination schema (the <code>OMAP</code> DB). It supports near-real-time updates (FastChange) and bulk runs (SlowChange).</p>
<h1 data-heading="Content" dir="auto">Content</h1>
<ol>
<li dir="auto">High-level architecture</li>
<li dir="auto">Mapping </li>
<li dir="auto">FastChange</li>
<li dir="auto">SlowChange</li>
<li dir="auto">Files (quick overview)</li>
<li dir="auto">Stored Procedures</li>
</ol>
<h2 data-heading="High-level-architecture" dir="auto">High-level-architecture</h2>
<ul>
<li dir="auto"><strong>Mapping definition</strong>: Data team provides an Excel file (4 sheets). The mapping upload tool extracts sheets, copies them into the <code>OMAP_ETL</code> database and runs <code>SP_ETL_Mapping_Tables_Preparation</code> which converts the raw sheets into tables <code>fieldsMapping</code> and <code>valuesMapping</code>.</li>
<li dir="auto"><strong>FastChange</strong>: SQL Agent jobs execute stored procedures at ~10s frequency to sync recent changes from source to destination.</li>
<li dir="auto"><strong>SlowChange</strong>: Insert into <code>ETL_Jobs</code> via UI or scheduled jobs which loops over mapping combinations and calls <code>SP_ETL_SC_Sync_Entity</code> which is responsible for synchronizing the data.</li>
</ul>
<div class="mermaid"><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 1231.5078125 578" height="578" class="flowchart" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="1231.5078125" id="mfe44c745eeafc122"><style>#mfe44c745eeafc122{font-family:var(--font-mermaid);font-size:16px;fill:#333;}#mfe44c745eeafc122 .error-icon{fill:#552222;}#mfe44c745eeafc122 .error-text{fill:#552222;stroke:#552222;}#mfe44c745eeafc122 .edge-thickness-normal{stroke-width:1px;}#mfe44c745eeafc122 .edge-thickness-thick{stroke-width:3.5px;}#mfe44c745eeafc122 .edge-pattern-solid{stroke-dasharray:0;}#mfe44c745eeafc122 .edge-thickness-invisible{stroke-width:0;fill:none;}#mfe44c745eeafc122 .edge-pattern-dashed{stroke-dasharray:3;}#mfe44c745eeafc122 .edge-pattern-dotted{stroke-dasharray:2;}#mfe44c745eeafc122 .marker{fill:#333333;stroke:#333333;}#mfe44c745eeafc122 .marker.cross{stroke:#333333;}#mfe44c745eeafc122 svg{font-family:var(--font-mermaid);font-size:16px;}#mfe44c745eeafc122 p{margin:0;}#mfe44c745eeafc122 .label{font-family:var(--font-mermaid);color:#333;}#mfe44c745eeafc122 .cluster-label text{fill:#333;}#mfe44c745eeafc122 .cluster-label span{color:#333;}#mfe44c745eeafc122 .cluster-label span p{background-color:transparent;}#mfe44c745eeafc122 .label text,#mfe44c745eeafc122 span{fill:#333;color:#333;}#mfe44c745eeafc122 .node rect,#mfe44c745eeafc122 .node circle,#mfe44c745eeafc122 .node ellipse,#mfe44c745eeafc122 .node polygon,#mfe44c745eeafc122 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mfe44c745eeafc122 .rough-node .label text,#mfe44c745eeafc122 .node .label text,#mfe44c745eeafc122 .image-shape .label,#mfe44c745eeafc122 .icon-shape .label{text-anchor:middle;}#mfe44c745eeafc122 .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#mfe44c745eeafc122 .rough-node .label,#mfe44c745eeafc122 .node .label,#mfe44c745eeafc122 .image-shape .label,#mfe44c745eeafc122 .icon-shape .label{text-align:center;}#mfe44c745eeafc122 .node.clickable{cursor:pointer;}#mfe44c745eeafc122 .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#mfe44c745eeafc122 .arrowheadPath{fill:#333333;}#mfe44c745eeafc122 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mfe44c745eeafc122 .flowchart-link{stroke:#333333;fill:none;}#mfe44c745eeafc122 .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#mfe44c745eeafc122 .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#mfe44c745eeafc122 .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#mfe44c745eeafc122 .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#mfe44c745eeafc122 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mfe44c745eeafc122 .cluster text{fill:#333;}#mfe44c745eeafc122 .cluster span{color:#333;}#mfe44c745eeafc122 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:var(--font-mermaid);font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mfe44c745eeafc122 .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#mfe44c745eeafc122 rect.text{fill:none;stroke-width:0;}#mfe44c745eeafc122 .icon-shape,#mfe44c745eeafc122 .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#mfe44c745eeafc122 .icon-shape p,#mfe44c745eeafc122 .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#mfe44c745eeafc122 .icon-shape rect,#mfe44c745eeafc122 .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#mfe44c745eeafc122 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}
:root {
  --default-font: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Microsoft YaHei Light", sans-serif;
  --font-monospace: 'Source Code Pro', monospace;
  --background-primary: #ffffff;
  --background-modifier-border: #ddd;
  --text-accent: #705dcf;
  --text-accent-hover: #7a6ae6;
  --text-normal: #2e3338;
  --background-secondary: #f2f3f5;
  --background-secondary-alt: #e3e5e8;
  --text-muted: #888888;
}</style><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mfe44c745eeafc122-mfe44c745eeafc122_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mfe44c745eeafc122-mfe44c745eeafc122_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mfe44c745eeafc122-mfe44c745eeafc122_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mfe44c745eeafc122-mfe44c745eeafc122_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mfe44c745eeafc122-mfe44c745eeafc122_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mfe44c745eeafc122-mfe44c745eeafc122_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"><g data-look="classic" id="SlowChange" class="cluster"><rect height="385" width="310.015625" y="8" x="913.4921875" style=""></rect><g transform="translate(1022.6796875, 8)" class="cluster-label"><foreignObject height="24" width="91.640625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Slow Change</p></span></div></foreignObject></g></g><g data-look="classic" id="FastChange" class="cluster"><rect height="256" width="310.015625" y="137" x="583.4765625" style=""></rect><g transform="translate(695.5078125, 137)" class="cluster-label"><foreignObject height="24" width="85.953125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Fast Change</p></span></div></foreignObject></g></g><g data-look="classic" id="Mapping" class="cluster"><rect height="433" width="555.4765625" y="137" x="8" style=""></rect><g transform="translate(253.90234375, 137)" class="cluster-label"><foreignObject height="24" width="63.671875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Mapping</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mfe44c745eeafc122-mfe44c745eeafc122_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M213.758,240L213.758,244.167C213.758,248.333,213.758,256.667,213.758,264.333C213.758,272,213.758,279,213.758,282.5L213.758,286"></path><path marker-end="url(#mfe44c745eeafc122-mfe44c745eeafc122_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_D_1" d="M213.758,368L213.758,372.167C213.758,376.333,213.758,384.667,213.758,395C213.758,405.333,213.758,417.667,220.743,429.577C227.727,441.487,241.697,452.973,248.682,458.716L255.667,464.46"></path><path marker-end="url(#mfe44c745eeafc122-mfe44c745eeafc122_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_FJ_FJOP_2" d="M738.484,240L738.484,244.167C738.484,248.333,738.484,256.667,738.484,264.333C738.484,272,738.484,279,738.484,282.5L738.484,286"></path><path marker-end="url(#mfe44c745eeafc122-mfe44c745eeafc122_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_UI_INS_3" d="M1068.5,87L1068.5,91.167C1068.5,95.333,1068.5,103.667,1068.5,112C1068.5,120.333,1068.5,128.667,1068.5,138.333C1068.5,148,1068.5,159,1068.5,164.5L1068.5,170"></path><path marker-end="url(#mfe44c745eeafc122-mfe44c745eeafc122_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_INS_SJOP_4" d="M1068.5,228L1068.5,234.167C1068.5,240.333,1068.5,252.667,1068.5,262.333C1068.5,272,1068.5,279,1068.5,282.5L1068.5,286"></path><path marker-end="url(#mfe44c745eeafc122-mfe44c745eeafc122_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_FJOP_D_5" d="M703.443,368L699.699,372.167C695.955,376.333,688.468,384.667,622.259,395C556.049,405.333,431.118,417.667,368.653,429.333C306.188,441,306.188,452,306.188,457.5L306.188,463"></path><path marker-end="url(#mfe44c745eeafc122-mfe44c745eeafc122_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_SJOP_D_6" d="M1033.459,368L1029.715,372.167C1025.971,376.333,1018.484,384.667,924.748,395C831.013,405.333,651.03,417.667,548.267,429.721C445.504,441.775,419.962,453.55,407.19,459.438L394.419,465.325"></path><path marker-end="url(#mfe44c745eeafc122-mfe44c745eeafc122_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_FJOP_DEST_7" d="M779.62,368L784.014,372.167C788.409,376.333,797.199,384.667,801.593,395C805.988,405.333,805.988,417.667,818.772,429.721C831.555,441.776,857.121,453.551,869.905,459.439L882.688,465.327"></path><path marker-end="url(#mfe44c745eeafc122-mfe44c745eeafc122_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_SJOP_DEST_8" d="M1109.635,368L1114.03,372.167C1118.425,376.333,1127.214,384.667,1131.609,395C1136.004,405.333,1136.004,417.667,1123.221,429.721C1110.437,441.776,1084.871,453.551,1072.088,459.439L1059.304,465.327"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(306.1875, 430)" class="edgeLabel"><g transform="translate(-72.4296875, -12)" class="label"><foreignObject height="24" width="144.859375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>uses mapping tables</p></span></div></foreignObject></g></g><g transform="translate(471.046875, 430)" class="edgeLabel"><g transform="translate(-72.4296875, -12)" class="label"><foreignObject height="24" width="144.859375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>uses mapping tables</p></span></div></foreignObject></g></g><g transform="translate(805.98828125, 430)" class="edgeLabel"><g transform="translate(-30.3828125, -12)" class="label"><foreignObject height="24" width="60.765625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>writes to</p></span></div></foreignObject></g></g><g transform="translate(1136.00390625, 430)" class="edgeLabel"><g transform="translate(-30.3828125, -12)" class="label"><foreignObject height="24" width="60.765625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>writes to</p></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(213.7578125, 201)" id="flowchart-A-223" class="node default"><rect height="78" width="163.125" y="-39" x="-81.5625" style="" class="basic label-container"></rect><g transform="translate(-51.5625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="103.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Mapping Excel<br>4 sheets</p></span></div></foreignObject></g></g><g transform="translate(213.7578125, 329)" id="flowchart-B-224" class="node default"><rect height="78" width="341.515625" y="-39" x="-170.7578125" style="" class="basic label-container"></rect><g transform="translate(-140.7578125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="281.515625"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Upload tool<br>Upload_OMAP_ETL_Mapping_Service.py</p></span></div></foreignObject></g></g><g transform="translate(306.1875, 506)" id="flowchart-D-225" class="node default"><rect height="78" width="260" y="-39" x="-130" style="" class="basic label-container"></rect><g transform="translate(-100, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>fieldsMapping / valuesMapping</p></span></div></foreignObject></g></g><g transform="translate(738.484375, 201)" id="flowchart-FJ-229" class="node default"><rect height="78" width="170.734375" y="-39" x="-85.3671875" style="" class="basic label-container"></rect><g transform="translate(-55.3671875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="110.734375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>SQL Agent Jobs<br> run every 10s</p></span></div></foreignObject></g></g><g transform="translate(738.484375, 329)" id="flowchart-FJOP-230" class="node default"><rect height="78" width="240.015625" y="-39" x="-120.0078125" style="" class="basic label-container"></rect><g transform="translate(-90.0078125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="180.015625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Run necessary operations<br>more details later</p></span></div></foreignObject></g></g><g transform="translate(1068.5, 60)" id="flowchart-UI-233" class="node default"><rect height="54" width="220.96875" y="-27" x="-110.484375" style="" class="basic label-container"></rect><g transform="translate(-80.484375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="160.96875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>ETL UI / Scheduled Job</p></span></div></foreignObject></g></g><g transform="translate(1068.5, 201)" id="flowchart-INS-234" class="node default"><rect height="54" width="176.375" y="-27" x="-88.1875" style="" class="basic label-container"></rect><g transform="translate(-58.1875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="116.375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>INSERT ETL_Jobs</p></span></div></foreignObject></g></g><g transform="translate(1068.5, 329)" id="flowchart-SJOP-235" class="node default"><rect height="78" width="240.015625" y="-39" x="-120.0078125" style="" class="basic label-container"></rect><g transform="translate(-90.0078125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="180.015625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Run necessary operations<br>more details later</p></span></div></foreignObject></g></g><g transform="translate(970.99609375, 506)" id="flowchart-DEST-239" class="node default"><rect height="78" width="260" y="-39" x="-130" style="" class="basic label-container"></rect><g transform="translate(-100, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Destination Database OMAP</p></span></div></foreignObject></g></g></g></g></g>"<marker id="mermaid_arrowhead" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker>"</svg></div>
<h2 data-heading="Mapping" dir="auto">Mapping</h2>
<ul>
<li dir="auto">Excel sheets (provided by data team):
<ul>
<li dir="auto"><strong>Object Classes (valuesMapping)</strong>: represents subtypes and their value mappings.</li>
<li dir="auto"><strong>Fields (fieldsMapping)</strong>: represents schema mapping.</li>
<li dir="auto"><strong>Domains (valuesMapping)</strong>: represents domains mapping.</li>
<li dir="auto"><strong>Domains | Subtypes | Values(valuesMapping)</strong>: represents other values mappings text to number, number to text, domain to text or number ... etc.</li>
</ul>
</li>
<li dir="auto">Final tables:<br>
The 4 sheets are converted to the following two tables to be used in the app:
<ul>
<li dir="auto"><code>fieldsMapping</code> — field/entity-level mapping used by sync procedures.</li>
<li dir="auto"><code>valuesMapping</code> — domain/value mapping used to convert coded values.</li>
</ul>
</li>
<li dir="auto">Mapping pipeline:
<ol>
<li dir="auto">Upload Excel via ETL tool (<code>Upload mapping</code> tab): this is a Geoprocessing tool, it's code could be found at <code>Upload_OMAP_ETL_Mapping_Service.py</code>.</li>
<li dir="auto">Sheets extracted to a temporary geodatabase and then copied into <code>OMAP_ETL</code> raw tables.</li>
<li dir="auto">The script runs <code>SP_ETL_Mapping_Tables_Preparation</code> to populate <code>fieldsMapping</code> and <code>valuesMapping</code>.</li>
</ol>
</li>
</ul>
<h2 data-heading="FastChange" dir="auto">FastChange</h2>
<p dir="auto">Purpose: capture and apply source edits quickly (two pipelines run in parallel to meet time limitation).</p>
<ul>
<li dir="auto"><strong>Jobs &amp; procedures</strong>:
<ul>
<li dir="auto"><code>FastChange_Plot_Duqm_Job</code> → <code>SP_ETL_FastChange_Duqm</code></li>
<li dir="auto"><code>FastChange_Plots_Other_Than_Duqm_Job</code> → <code>SP_ETL_FastChange_Plots_Other_Than_Duqm</code></li>
</ul>
</li>
<li dir="auto">Why two jobs: Duqm and non-Duqm zones have different worst-case run times and must both complete within ~10s; running them in parallel avoids missing the time window.</li>
</ul>
<h3 data-heading="FastChange flow (per job):" dir="auto">FastChange flow (per job):</h3>
<ol>
<li dir="auto">Confirm node is primary replica (AG check).</li>
<li dir="auto">Run <code>SP_ETL_Plot_Pre_Sync</code> — adds RowHash/meta fields, creates archives, statistics table and supporting views.</li>
<li dir="auto">Run <code>SP_ETL_FC_Sync_Entity</code> — core sync (select, compute RowHash, compare, delete/insert rows).</li>
<li dir="auto">Sync deletions via <code>SP_ETL_CppLotWGS84_Cpplotpoint_Sync_Delete</code>.</li>
<li dir="auto">Project results to WGS84 via <code>SP_ETL_Plot_Projection</code> + <code>projectionScript.py</code>.</li>
<li dir="auto">Finalize via <code>SP_ETL_Plot_Post_Sync</code> (load cpplotPoint, recalc stats).</li>
</ol>
<div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-78 -10 2961.5 1727" height="1727" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="2961.5" id="m2ea9d5f402220590"><g><rect class="actor actor-bottom" ry="3" rx="3" name="DB" height="65" width="511" stroke="#666" fill="#eaeaea" y="1641" x="2322.5"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1673.5" x="2578"><tspan dy="-8" x="2578">OMAP Database Tables </tspan></text><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1673.5" x="2578"><tspan dy="8" x="2578"> (cpplot39/40/WGS84, cpplot39/40_Archive, cpplotpoint and statistics)</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Post" height="65" width="178" stroke="#666" fill="#eaeaea" y="1641" x="2094.5"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1673.5" x="2183.5"><tspan dy="0" x="2183.5">SP_ETL_Plot_Post_Sync</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="PyScript" height="65" width="153" stroke="#666" fill="#eaeaea" y="1641" x="1891.5"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1673.5" x="1968"><tspan dy="0" x="1968">projectionScript.py</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Proj" height="65" width="180" stroke="#666" fill="#eaeaea" y="1641" x="1645"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1673.5" x="1735"><tspan dy="0" x="1735">SP_ETL_Plot_Projection</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Del" height="65" width="360" stroke="#666" fill="#eaeaea" y="1641" x="1235"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1673.5" x="1415"><tspan dy="0" x="1415">SP_ETL_CppLotWGS84_Cpplotpoint_Sync_Delete</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Sync" height="65" width="178" stroke="#666" fill="#eaeaea" y="1641" x="1007"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1673.5" x="1096"><tspan dy="0" x="1096">SP_ETL_FC_Sync_Entity</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Pre" height="65" width="171" stroke="#666" fill="#eaeaea" y="1641" x="786"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1673.5" x="871.5"><tspan dy="0" x="871.5">SP_ETL_Plot_Pre_Sync</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="AG" height="65" width="150" stroke="#666" fill="#eaeaea" y="1641" x="586"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1673.5" x="661"><tspan dy="0" x="661">Availability Group</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Job" height="65" width="336" stroke="#666" fill="#eaeaea" y="1641" x="200"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1673.5" x="368"><tspan dy="-8" x="368">SP_ETL_FastChange_Duqm </tspan></text><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1673.5" x="368"><tspan dy="8" x="368"> SP_ETL_FastChange_Plots_Other_Than_Duqm</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Agt" height="65" width="150" stroke="#666" fill="#eaeaea" y="1641" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1673.5" x="75"><tspan dy="0" x="75">SQL Agent Job</tspan></text></g><g><line name="DB" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1641" x2="2578" y1="65" x1="2578" id="actor186"></line><g id="root-186"><rect class="actor actor-top" ry="3" rx="3" name="DB" height="65" width="511" stroke="#666" fill="#eaeaea" y="0" x="2322.5"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="2578"><tspan dy="-8" x="2578">OMAP Database Tables </tspan></text><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="2578"><tspan dy="8" x="2578"> (cpplot39/40/WGS84, cpplot39/40_Archive, cpplotpoint and statistics)</tspan></text></g></g><g><line name="Post" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1641" x2="2183.5" y1="65" x1="2183.5" id="actor185"></line><g id="root-185"><rect class="actor actor-top" ry="3" rx="3" name="Post" height="65" width="178" stroke="#666" fill="#eaeaea" y="0" x="2094.5"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="2183.5"><tspan dy="0" x="2183.5">SP_ETL_Plot_Post_Sync</tspan></text></g></g><g><line name="PyScript" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1641" x2="1968" y1="65" x1="1968" id="actor184"></line><g id="root-184"><rect class="actor actor-top" ry="3" rx="3" name="PyScript" height="65" width="153" stroke="#666" fill="#eaeaea" y="0" x="1891.5"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1968"><tspan dy="0" x="1968">projectionScript.py</tspan></text></g></g><g><line name="Proj" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1641" x2="1735" y1="65" x1="1735" id="actor183"></line><g id="root-183"><rect class="actor actor-top" ry="3" rx="3" name="Proj" height="65" width="180" stroke="#666" fill="#eaeaea" y="0" x="1645"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1735"><tspan dy="0" x="1735">SP_ETL_Plot_Projection</tspan></text></g></g><g><line name="Del" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1641" x2="1415" y1="65" x1="1415" id="actor182"></line><g id="root-182"><rect class="actor actor-top" ry="3" rx="3" name="Del" height="65" width="360" stroke="#666" fill="#eaeaea" y="0" x="1235"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1415"><tspan dy="0" x="1415">SP_ETL_CppLotWGS84_Cpplotpoint_Sync_Delete</tspan></text></g></g><g><line name="Sync" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1641" x2="1096" y1="65" x1="1096" id="actor181"></line><g id="root-181"><rect class="actor actor-top" ry="3" rx="3" name="Sync" height="65" width="178" stroke="#666" fill="#eaeaea" y="0" x="1007"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1096"><tspan dy="0" x="1096">SP_ETL_FC_Sync_Entity</tspan></text></g></g><g><line name="Pre" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1641" x2="871.5" y1="65" x1="871.5" id="actor180"></line><g id="root-180"><rect class="actor actor-top" ry="3" rx="3" name="Pre" height="65" width="171" stroke="#666" fill="#eaeaea" y="0" x="786"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="871.5"><tspan dy="0" x="871.5">SP_ETL_Plot_Pre_Sync</tspan></text></g></g><g><line name="AG" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1641" x2="661" y1="65" x1="661" id="actor179"></line><g id="root-179"><rect class="actor actor-top" ry="3" rx="3" name="AG" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="586"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="661"><tspan dy="0" x="661">Availability Group</tspan></text></g></g><g><line name="Job" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1641" x2="368" y1="65" x1="368" id="actor178"></line><g id="root-178"><rect class="actor actor-top" ry="3" rx="3" name="Job" height="65" width="336" stroke="#666" fill="#eaeaea" y="0" x="200"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="368"><tspan dy="-8" x="368">SP_ETL_FastChange_Duqm </tspan></text><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="368"><tspan dy="8" x="368"> SP_ETL_FastChange_Plots_Other_Than_Duqm</tspan></text></g></g><g><line name="Agt" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1641" x2="75" y1="65" x1="75" id="actor177"></line><g id="root-177"><rect class="actor actor-top" ry="3" rx="3" name="Agt" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">SQL Agent Job</tspan></text></g></g><style>#m2ea9d5f402220590{font-family:var(--font-mermaid);font-size:16px;fill:#333;}#m2ea9d5f402220590 .error-icon{fill:#552222;}#m2ea9d5f402220590 .error-text{fill:#552222;stroke:#552222;}#m2ea9d5f402220590 .edge-thickness-normal{stroke-width:1px;}#m2ea9d5f402220590 .edge-thickness-thick{stroke-width:3.5px;}#m2ea9d5f402220590 .edge-pattern-solid{stroke-dasharray:0;}#m2ea9d5f402220590 .edge-thickness-invisible{stroke-width:0;fill:none;}#m2ea9d5f402220590 .edge-pattern-dashed{stroke-dasharray:3;}#m2ea9d5f402220590 .edge-pattern-dotted{stroke-dasharray:2;}#m2ea9d5f402220590 .marker{fill:#333333;stroke:#333333;}#m2ea9d5f402220590 .marker.cross{stroke:#333333;}#m2ea9d5f402220590 svg{font-family:var(--font-mermaid);font-size:16px;}#m2ea9d5f402220590 p{margin:0;}#m2ea9d5f402220590 .actor{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;}#m2ea9d5f402220590 text.actor&gt;tspan{fill:black;stroke:none;}#m2ea9d5f402220590 .actor-line{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);}#m2ea9d5f402220590 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333;}#m2ea9d5f402220590 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333;}#m2ea9d5f402220590 #m2ea9d5f402220590-arrowhead path{fill:#333;stroke:#333;}#m2ea9d5f402220590 .sequenceNumber{fill:white;}#m2ea9d5f402220590 #m2ea9d5f402220590-sequencenumber{fill:#333;}#m2ea9d5f402220590 #m2ea9d5f402220590-crosshead path{fill:#333;stroke:#333;}#m2ea9d5f402220590 .messageText{fill:#333;stroke:none;}#m2ea9d5f402220590 .labelBox{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;}#m2ea9d5f402220590 .labelText,#m2ea9d5f402220590 .labelText&gt;tspan{fill:black;stroke:none;}#m2ea9d5f402220590 .loopText,#m2ea9d5f402220590 .loopText&gt;tspan{fill:black;stroke:none;}#m2ea9d5f402220590 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);}#m2ea9d5f402220590 .note{stroke:#aaaa33;fill:#fff5ad;}#m2ea9d5f402220590 .noteText,#m2ea9d5f402220590 .noteText&gt;tspan{fill:black;stroke:none;}#m2ea9d5f402220590 .activation0{fill:#f4f4f4;stroke:#666;}#m2ea9d5f402220590 .activation1{fill:#f4f4f4;stroke:#666;}#m2ea9d5f402220590 .activation2{fill:#f4f4f4;stroke:#666;}#m2ea9d5f402220590 .actorPopupMenu{position:absolute;}#m2ea9d5f402220590 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0px 8px 16px 0px rgba(0,0,0,0.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / 0.4));}#m2ea9d5f402220590 .actor-man line{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;}#m2ea9d5f402220590 .actor-man circle,#m2ea9d5f402220590 line{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;stroke-width:2px;}#m2ea9d5f402220590 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}
:root {
  --default-font: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Microsoft YaHei Light", sans-serif;
  --font-monospace: 'Source Code Pro', monospace;
  --background-primary: #ffffff;
  --background-modifier-border: #ddd;
  --text-accent: #705dcf;
  --text-accent-hover: #7a6ae6;
  --text-normal: #2e3338;
  --background-secondary: #f2f3f5;
  --background-secondary-alt: #e3e5e8;
  --text-muted: #888888;
}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="m2ea9d5f402220590-arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="m2ea9d5f402220590-crosshead"><path style="stroke-dasharray: 0, 0;" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="m2ea9d5f402220590-filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="m2ea9d5f402220590-sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><g><rect class="note" height="104" width="204" stroke="#666" fill="#EDF2AE" y="283" x="769.5"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="288" x="872"><tspan x="872">Add RowHash/meta fields</tspan></text><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="309" x="872"><tspan x="872">Create archives</tspan></text><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="330" x="872"><tspan x="872">Create statistics table</tspan></text><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="351" x="872"><tspan x="872">Create supporting views</tspan></text></g><g><rect class="note" height="125" width="207" stroke="#666" fill="#EDF2AE" y="553" x="992.5"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="558" x="1096"><tspan x="1096">SELECT source data</tspan></text><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="579" x="1096"><tspan x="1096">Compute RowHash</tspan></text><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="600" x="1096"><tspan x="1096">Compare with target</tspan></text><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="621" x="1096"><tspan x="1096">DELETE changed rows</tspan></text><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="642" x="1096"><tspan x="1096">INSERT new/updated rows</tspan></text></g><g><rect class="note" height="62" width="360" stroke="#666" fill="#EDF2AE" y="844" x="1235"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="849" x="1415"><tspan x="1415">Sync deletions between</tspan></text><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="870" x="1415"><tspan x="1415">cpplotWGS84 and cpplotPoint</tspan></text></g><g><rect class="note" height="62" width="241" stroke="#666" fill="#EDF2AE" y="1124" x="1847.5"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1129" x="1968"><tspan x="1968">Copy new and updated records </tspan></text><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1150" x="1968"><tspan x="1968"> from cpplot39/40 to WGS84</tspan></text></g><g><rect class="note" height="62" width="178" stroke="#666" fill="#EDF2AE" y="1352" x="2094.5"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1357" x="2184"><tspan x="2184">Load cpplotPoint</tspan></text><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1378" x="2184"><tspan x="2184">Recalculate statistics</tspan></text></g><g><rect class="note" height="41" width="206" stroke="#666" fill="#EDF2AE" y="1580" x="-28"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1585" x="75"><tspan x="75">FastChange flow complete</tspan></text></g><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="220">Run the stored procedure</text><line style="fill: none;" marker-end="url(#m2ea9d5f402220590-arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="117" x2="364" y1="117" x1="76"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="132" x="513">Check if primary replica</text><line style="fill: none;" marker-end="url(#m2ea9d5f402220590-arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="169" x2="657" y1="169" x1="369"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="184" x="516">Confirmed primary</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#m2ea9d5f402220590-arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="221" x2="372" y1="221" x1="660"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="236" x="618">Execute SP_ETL_Plot_Pre_Sync</text><line style="fill: none;" marker-end="url(#m2ea9d5f402220590-arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="273" x2="867.5" y1="273" x1="369"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="402" x="1723">Update destination tables</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#m2ea9d5f402220590-arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="439" x2="2574" y1="439" x1="872.5"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="454" x="621">Pre-sync complete</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#m2ea9d5f402220590-arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="491" x2="372" y1="491" x1="870.5"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="506" x="731">Execute SP_ETL_FC_Sync_Entity</text><line style="fill: none;" marker-end="url(#m2ea9d5f402220590-arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="543" x2="1092" y1="543" x1="369"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="693" x="1836">Update target tables</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#m2ea9d5f402220590-arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="730" x2="2574" y1="730" x1="1097"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="745" x="734">Sync complete</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#m2ea9d5f402220590-arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="782" x2="372" y1="782" x1="1095"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="797" x="890">Execute SP_ETL_CppLotWGS84_Cpplotpoint_Sync_Delete</text><line style="fill: none;" marker-end="url(#m2ea9d5f402220590-arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="834" x2="1411" y1="834" x1="369"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="921" x="1995">Apply deletions</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#m2ea9d5f402220590-arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="958" x2="2574" y1="958" x1="1416"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="973" x="893">Deletion sync complete</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#m2ea9d5f402220590-arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="1010" x2="372" y1="1010" x1="1414"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1025" x="1050">Execute SP_ETL_Plot_Projection</text><line style="fill: none;" marker-end="url(#m2ea9d5f402220590-arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1062" x2="1731" y1="1062" x1="369"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1077" x="1850">Call projectionScript.py</text><line style="fill: none;" marker-end="url(#m2ea9d5f402220590-arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1114" x2="1964" y1="1114" x1="1736"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1201" x="2155">Update cpplotWGS84 table</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#m2ea9d5f402220590-arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="1238" x2="2574" y1="1238" x1="1736"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1253" x="1053">Projection complete</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#m2ea9d5f402220590-arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="1290" x2="372" y1="1290" x1="1734"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1305" x="1274">Execute SP_ETL_Plot_Post_Sync</text><line style="fill: none;" marker-end="url(#m2ea9d5f402220590-arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1342" x2="2179.5" y1="1342" x1="369"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1429" x="2379">Finalize updates</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#m2ea9d5f402220590-arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="1466" x2="2574" y1="1466" x1="2184.5"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1481" x="1277">Post-sync complete</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#m2ea9d5f402220590-arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="1518" x2="372" y1="1518" x1="2182.5"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1533" x="223">Job is finished</text><line style="fill: none;" marker-end="url(#m2ea9d5f402220590-arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1570" x2="79" y1="1570" x1="367"></line>"<marker id="mermaid_arrowhead" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker>"</svg></div>
<h2 data-heading="SlowChange" dir="auto">SlowChange</h2>
<p dir="auto">Purpose: run full or filtered synchronizations initiated via UI or scheduled job.</p>
<p dir="auto">Initiation &amp; orchestration:</p>
<ol>
<li dir="auto">User/UI or scheduled process inserts a row into <code>OMAP_ETL.dbo.ETL_Jobs</code> (fields: DestEntity, SourceDB, SourceEntityGroup — <strong>all optional; unspecified = all</strong>).</li>
<li dir="auto"><code>TRGR_ETL_JOBS_After_Insert</code> runs and starts the SQL Agent job <code>ETL_SC_RUN_NotExecuted_Job</code> (this decouples the trigger transaction from the dynamic SQL run).</li>
<li dir="auto"><code>ETL_SC_RUN_NotExecuted_Job</code> picks the not-executed job and calls <code>SP_ETL_SC_Run_Job</code>.</li>
<li dir="auto"><code>SP_ETL_SC_Run_Job</code> calls <code>SP_ETL_SC_Prepare_Job</code> then loops over distinct mapping combos and calls <code>SP_ETL_SC_Sync_Entity</code> for each.</li>
</ol>
<div class="mermaid"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 2215.5 798" height="798" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="2215.5" id="m6b5070ca39905674"><g><rect class="actor actor-bottom" ry="3" rx="3" name="Sync" height="65" width="179" stroke="#666" fill="#eaeaea" y="712" x="1936.5"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="744.5" x="2026"><tspan dy="0" x="2026">SP_ETL_SC_Sync_Entity</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Prep" height="65" width="185" stroke="#666" fill="#eaeaea" y="712" x="1701.5"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="744.5" x="1794"><tspan dy="0" x="1794">SP_ETL_SC_Prepare_Job</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Runner" height="65" width="159" stroke="#666" fill="#eaeaea" y="712" x="1449.5"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="744.5" x="1529"><tspan dy="0" x="1529">SP_ETL_SC_Run_Job</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Agent" height="65" width="150" stroke="#666" fill="#eaeaea" y="712" x="1213"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="744.5" x="1288"><tspan dy="0" x="1288">SQL Agent Job</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="TR" height="65" width="150" stroke="#666" fill="#eaeaea" y="712" x="832"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="744.5" x="907"><tspan dy="0" x="907">Trigger</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="DB" height="65" width="150" stroke="#666" fill="#eaeaea" y="712" x="529"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="744.5" x="604"><tspan dy="0" x="604">OMAP_ETL DB</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="UI" height="65" width="150" stroke="#666" fill="#eaeaea" y="712" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="744.5" x="75"><tspan dy="0" x="75">ETL UI / User</tspan></text></g><g><line name="Sync" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="712" x2="2026" y1="65" x1="2026" id="actor193"></line><g id="root-193"><rect class="actor actor-top" ry="3" rx="3" name="Sync" height="65" width="179" stroke="#666" fill="#eaeaea" y="0" x="1936.5"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="2026"><tspan dy="0" x="2026">SP_ETL_SC_Sync_Entity</tspan></text></g></g><g><line name="Prep" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="712" x2="1794" y1="65" x1="1794" id="actor192"></line><g id="root-192"><rect class="actor actor-top" ry="3" rx="3" name="Prep" height="65" width="185" stroke="#666" fill="#eaeaea" y="0" x="1701.5"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1794"><tspan dy="0" x="1794">SP_ETL_SC_Prepare_Job</tspan></text></g></g><g><line name="Runner" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="712" x2="1529" y1="65" x1="1529" id="actor191"></line><g id="root-191"><rect class="actor actor-top" ry="3" rx="3" name="Runner" height="65" width="159" stroke="#666" fill="#eaeaea" y="0" x="1449.5"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1529"><tspan dy="0" x="1529">SP_ETL_SC_Run_Job</tspan></text></g></g><g><line name="Agent" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="712" x2="1288" y1="65" x1="1288" id="actor190"></line><g id="root-190"><rect class="actor actor-top" ry="3" rx="3" name="Agent" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1213"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1288"><tspan dy="0" x="1288">SQL Agent Job</tspan></text></g></g><g><line name="TR" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="712" x2="907" y1="65" x1="907" id="actor189"></line><g id="root-189"><rect class="actor actor-top" ry="3" rx="3" name="TR" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="832"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="907"><tspan dy="0" x="907">Trigger</tspan></text></g></g><g><line name="DB" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="712" x2="604" y1="65" x1="604" id="actor188"></line><g id="root-188"><rect class="actor actor-top" ry="3" rx="3" name="DB" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="529"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="604"><tspan dy="0" x="604">OMAP_ETL DB</tspan></text></g></g><g><line name="UI" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="712" x2="75" y1="65" x1="75" id="actor187"></line><g id="root-187"><rect class="actor actor-top" ry="3" rx="3" name="UI" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">ETL UI / User</tspan></text></g></g><style>#m6b5070ca39905674{font-family:var(--font-mermaid);font-size:16px;fill:#333;}#m6b5070ca39905674 .error-icon{fill:#552222;}#m6b5070ca39905674 .error-text{fill:#552222;stroke:#552222;}#m6b5070ca39905674 .edge-thickness-normal{stroke-width:1px;}#m6b5070ca39905674 .edge-thickness-thick{stroke-width:3.5px;}#m6b5070ca39905674 .edge-pattern-solid{stroke-dasharray:0;}#m6b5070ca39905674 .edge-thickness-invisible{stroke-width:0;fill:none;}#m6b5070ca39905674 .edge-pattern-dashed{stroke-dasharray:3;}#m6b5070ca39905674 .edge-pattern-dotted{stroke-dasharray:2;}#m6b5070ca39905674 .marker{fill:#333333;stroke:#333333;}#m6b5070ca39905674 .marker.cross{stroke:#333333;}#m6b5070ca39905674 svg{font-family:var(--font-mermaid);font-size:16px;}#m6b5070ca39905674 p{margin:0;}#m6b5070ca39905674 .actor{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;}#m6b5070ca39905674 text.actor&gt;tspan{fill:black;stroke:none;}#m6b5070ca39905674 .actor-line{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);}#m6b5070ca39905674 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333;}#m6b5070ca39905674 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333;}#m6b5070ca39905674 #m6b5070ca39905674-arrowhead path{fill:#333;stroke:#333;}#m6b5070ca39905674 .sequenceNumber{fill:white;}#m6b5070ca39905674 #m6b5070ca39905674-sequencenumber{fill:#333;}#m6b5070ca39905674 #m6b5070ca39905674-crosshead path{fill:#333;stroke:#333;}#m6b5070ca39905674 .messageText{fill:#333;stroke:none;}#m6b5070ca39905674 .labelBox{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;}#m6b5070ca39905674 .labelText,#m6b5070ca39905674 .labelText&gt;tspan{fill:black;stroke:none;}#m6b5070ca39905674 .loopText,#m6b5070ca39905674 .loopText&gt;tspan{fill:black;stroke:none;}#m6b5070ca39905674 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);}#m6b5070ca39905674 .note{stroke:#aaaa33;fill:#fff5ad;}#m6b5070ca39905674 .noteText,#m6b5070ca39905674 .noteText&gt;tspan{fill:black;stroke:none;}#m6b5070ca39905674 .activation0{fill:#f4f4f4;stroke:#666;}#m6b5070ca39905674 .activation1{fill:#f4f4f4;stroke:#666;}#m6b5070ca39905674 .activation2{fill:#f4f4f4;stroke:#666;}#m6b5070ca39905674 .actorPopupMenu{position:absolute;}#m6b5070ca39905674 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0px 8px 16px 0px rgba(0,0,0,0.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / 0.4));}#m6b5070ca39905674 .actor-man line{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;}#m6b5070ca39905674 .actor-man circle,#m6b5070ca39905674 line{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;stroke-width:2px;}#m6b5070ca39905674 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}
:root {
  --default-font: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Microsoft YaHei Light", sans-serif;
  --font-monospace: 'Source Code Pro', monospace;
  --background-primary: #ffffff;
  --background-modifier-border: #ddd;
  --text-accent: #705dcf;
  --text-accent-hover: #7a6ae6;
  --text-normal: #2e3338;
  --background-secondary: #f2f3f5;
  --background-secondary-alt: #e3e5e8;
  --text-muted: #888888;
}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="m6b5070ca39905674-arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="m6b5070ca39905674-crosshead"><path style="stroke-dasharray: 0, 0;" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="m6b5070ca39905674-filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="m6b5070ca39905674-sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><g><rect class="note" height="41" width="253" stroke="#666" fill="#EDF2AE" y="127" x="629"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="132" x="756"><tspan x="756">TRGR_ETL_JOBS_After_Insert fires</tspan></text></g><g><line class="loopLine" y2="438" x2="2037" y1="438" x1="593"></line><line class="loopLine" y2="588" x2="2037" y1="438" x1="2037"></line><line class="loopLine" y2="588" x2="2037" y1="588" x1="593"></line><line class="loopLine" y2="588" x2="593" y1="438" x1="593"></line><polygon class="labelBox" points="593,438 643,438 643,451 634.6,458 593,458"></polygon><text style="font-size: 16px; font-weight: 400;" class="labelText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="451" x="618">loop</text><text style="font-size: 16px; font-weight: 400;" class="loopText" text-anchor="middle" y="456" x="1340"><tspan x="1340">[For each mapping combination]</tspan></text></g><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="338">INSERT INTO ETL_Jobs (DestEntity, SourceDB, SourceEntityGroup)</text><line style="fill: none;" marker-end="url(#m6b5070ca39905674-arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="117" x2="600" y1="117" x1="76"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="183" x="754">trigger fires</text><line style="fill: none;" marker-end="url(#m6b5070ca39905674-arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="220" x2="903" y1="220" x1="605"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="235" x="1096">sp_start_job 'ETL_SC_RUN_NotExecuted_Job'</text><line style="fill: none;" marker-end="url(#m6b5070ca39905674-arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="272" x2="1284" y1="272" x1="908"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="287" x="1407">Run SP_ETL_SC_Run_Job</text><line style="fill: none;" marker-end="url(#m6b5070ca39905674-arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="324" x2="1525" y1="324" x1="1289"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="339" x="1660">Call SP_ETL_SC_Prepare_Job</text><line style="fill: none;" marker-end="url(#m6b5070ca39905674-arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="376" x2="1790" y1="376" x1="1530"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="391" x="1663">prepare complete</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#m6b5070ca39905674-arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="428" x2="1533" y1="428" x1="1793"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="489" x="1776">call SP_ETL_SC_Sync_Entity</text><line style="fill: none;" marker-end="url(#m6b5070ca39905674-arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="526" x2="2022" y1="526" x1="1530"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="541" x="1317">success / failure logged</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#m6b5070ca39905674-arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="578" x2="608" y1="578" x1="2025"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="603" x="1410">overall run complete</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#m6b5070ca39905674-arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="640" x2="1292" y1="640" x1="1528"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="655" x="948">updates ETL_Jobs.IsExecuted</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#m6b5070ca39905674-arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="692" x2="608" y1="692" x1="1287"></line>"<marker id="mermaid_arrowhead" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker>"</svg></div>
<h2 data-heading="Files" dir="auto">Files</h2>
<ul>
<li dir="auto"><code>Upload_OMAP_ETL_Mapping_Service.py</code> — GP (Geoprocessing) tool that extracts mapping Excel to temp gdb and uploads raw tables to <code>OMAP_ETL</code> then run the <code>SP_ETL_Mapping_Tables_Preparation</code> to prepare <code>fieldsMapping</code> and <code>valuesMapping</code> tables.</li>
<li dir="auto"><code>SP_ETL_Mapping_Tables_Preparation.sql</code> — converts raw mapping sheets into <code>fieldsMapping</code> and <code>valuesMapping</code> tables.</li>
<li dir="auto"><code>SP_ETL_FastChange_Duqm.sql</code> — FastChange pipeline for Duqm.</li>
<li dir="auto"><code>SP_ETL_FastChange_Plots_Other_Than_Duqm.sql</code> — FastChange pipeline for other zones.</li>
<li dir="auto"><code>SP_ETL_Plot_Pre_Sync.sql</code> — Add ETL meta fields to destination tables, create archives, views and statistics.</li>
<li dir="auto"><code>SP_ETL_FC_Sync_Entity.sql</code> — Fast-change entity sync logic.</li>
<li dir="auto"><code>SP_ETL_CppLotWGS84_Cpplotpoint_Sync_Delete.sql</code> — Sync deletes.</li>
<li dir="auto"><code>projectionScript.py</code> &amp; <code>SP_ETL_Plot_Projection.sql</code> — Projection and loader to <code>cpplotWGS84</code>.</li>
<li dir="auto"><code>SP_ETL_Plot_Post_Sync.sql</code> — Finalize sync, load cpplotPoint and statistics.</li>
<li dir="auto"><code>SP_ETL_SC_Prepare_Job.sql</code> — Prepare mapping views and trim/normalize mapping tables.</li>
<li dir="auto"><code>TRGR_ETL_JOBS_After_Insert.sql</code> — Trigger to start job after insertion in <code>ETL_Jobs</code> table. </li>
<li dir="auto"><code>ETL_SC_Run_NotExecuted_Job.sql</code> — Agent job wrapper to run <code>SP_ETL_SC_Run_Job</code>.</li>
<li dir="auto"><code>SP_ETL_SC_Run_Job.sql</code> — Loop orchestration for slow-change jobs.</li>
<li dir="auto"><code>SP_ETL_SC_Sync_Entity.sql</code> — Main slow-change sync SP (validation, dynamic SQL, rowhash compare, logging).</li>
<li dir="auto"><code>fn_ExtractDigitsAsFloat.sql</code> — Extract numeric value from text helper.</li>
<li dir="auto"><code>fn_Get_Mapped_Field_Value.sql</code> —  Function for mapping values/codes.</li>
</ul>
<hr>
<h2 data-heading="Stored_Procedures" dir="auto">Stored_Procedures</h2>
<h3 data-heading="**`SP_ETL_FC_Sync_Entity`**" dir="auto"><strong><code>SP_ETL_FC_Sync_Entity</code></strong></h3>
<h2 data-heading="Overview" dir="auto">Overview</h2>
<p dir="auto"><code>SP_ETL_FC_Sync_Entity</code> is a Fast Change ETL stored procedure that synchronizes spatial entity data from a remote source database to the OMAP destination database via a linked server connection. It handles field mapping, data transformation, hash-based change detection, and maintains data integrity through archival before deletion, keep in mind this SP is only for Plot feature class.</p>
<h2 data-heading="Purpose" dir="auto">Purpose</h2>
<p dir="auto">This procedure performs incremental data synchronization for spatial entities (Plot) that change frequently, ensuring the destination database reflects the current state of the source data while preserving historical records(Archiving) .</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>@SourceDB</code></td>
<td>NVARCHAR(128)</td>
<td>Source database identifier used for mapping lookups</td>
</tr>
<tr>
<td><code>@SourceEntityGroup</code></td>
<td>NVARCHAR(255)</td>
<td>Logical grouping of related source entities/tables</td>
</tr>
<tr>
<td><code>@DestEntity</code></td>
<td>NVARCHAR(128)</td>
<td>Target entity/table name in the destination database</td>
</tr>
<tr>
<td><code>@JobID</code></td>
<td>BIGINT</td>
<td>Unique identifier for the ETL job execution</td>
</tr>
<tr>
<td><code>@LinkedServerName</code></td>
<td>NVARCHAR(128)</td>
<td>Name of the SQL Server linked server</td>
</tr>
<tr>
<td><code>@LinkedServerSourceDB</code></td>
<td>NVARCHAR(128)</td>
<td>Database name on the linked server</td>
</tr>
</tbody>
</table>
<h2 data-heading="Process Flow" dir="auto">Process Flow</h2>
<h3 data-heading="**Phase 1: Preparation &amp; Validation**" dir="auto"><strong>Phase 1: Preparation &amp; Validation</strong></h3>
<h4 data-heading="1. Retrieve Configuration Metadata" dir="auto">1. Retrieve Configuration Metadata</h4>
<ul>
<li dir="auto">Fetches schema name, SDE database name, entity suffix, and OPAZ Zone ID from <code>DBMappingMetaData</code></li>
<li dir="auto">Validates linked server existence</li>
<li dir="auto">Configures debugging mode</li>
</ul>
<h4 data-heading="2. Identify Source Tables" dir="auto">2. Identify Source Tables</h4>
<ul>
<li dir="auto">Queries <code>FieldsMapping</code> table to get all source entities involved in the synchronization</li>
<li dir="auto">Identifies the primary table (one without a primary key reference)</li>
<li dir="auto">Handles multi-table scenarios by cleaning up duplicates</li>
<li dir="auto">Creates temporary table <code>#sourceTables</code> with source entities, primary keys, and foreign keys</li>
</ul>
<h4 data-heading="3. Build Field Mapping table" dir="auto">3. Build Field Mapping table</h4>
<ul>
<li dir="auto">Extracts field mappings from <code>FieldsMapping</code> table</li>
<li dir="auto">Creates <code>#EntityFieldsMapping</code> temporary table containing:
<ul>
<li dir="auto">Source and destination field names</li>
<li dir="auto">Field types and data types</li>
<li dir="auto">Coded value indicators</li>
<li dir="auto">Reference relationships</li>
<li dir="auto">UTM zone information</li>
</ul>
</li>
</ul>
<h3 data-heading="**Phase 2: Data Extraction**" dir="auto"><strong>Phase 2: Data Extraction</strong></h3>
<h4 data-heading="1. Construct Dynamic OPENQUERY Statement" dir="auto">1. Construct Dynamic OPENQUERY Statement</h4>
<p dir="auto"><strong>1. Add Essential Spatial Fields</strong></p>
<ul>
<li dir="auto">Checks for <code>GlobalID</code> field existence in source</li>
<li dir="auto">Adds <code>GlobalID</code>, <code>OBJECTID</code>, and <code>Shape</code> fields to field mapping</li>
<li dir="auto">Generates new GUID if source lacks GlobalID</li>
</ul>
<p dir="auto"><strong>2. Build SELECT Clause</strong></p>
<ul>
<li dir="auto">Dynamically constructs SELECT statement from mapped fields</li>
<li dir="auto">Handles calculated fields (e.g., <code>NEWID()</code> for GlobalID)</li>
</ul>
<p dir="auto"><strong>3. Build FROM Clause with JOINs</strong></p>
<ul>
<li dir="auto">Creates base FROM clause with primary table</li>
<li dir="auto">Adds LEFT JOINs for related tables using primary/foreign key relationships</li>
<li dir="auto">Applies entity name suffix (e.g., <code>_evw</code> for enterprise views)</li>
<li dir="auto">Adds <code>WHERE Shape IS NOT NULL</code> filter</li>
</ul>
<p dir="auto"><strong>4. Execute OPENQUERY</strong></p>
<ul>
<li dir="auto">Pulls data from linked server into <code>##sourceDataBeforeHash</code> global temp table</li>
</ul>
<h3 data-heading="**Phase 3: Data Transformation**" dir="auto"><strong>Phase 3: Data Transformation</strong></h3>
<h4 data-heading="1. Apply Field Transformations" dir="auto">1. Apply Field Transformations</h4>
<p dir="auto"><strong>1. Update Field References</strong></p>
<ul>
<li dir="auto">Updates <code>sourceFieldFullName</code> to reference temp table columns</li>
</ul>
<p dir="auto"><strong>2. Handle Coded Values</strong></p>
<ul>
<li dir="auto">Applies <code>fn_Get_Mapped_Field_Value()</code> function for fields with domain/coded values mapping.</li>
<li dir="auto">Maps source coded values to destination domain values</li>
</ul>
<p dir="auto"><strong>3. Generate ID Fields</strong></p>
<ul>
<li dir="auto">Concatenates OPAZ Zone ID with UTM zone and field value</li>
<li dir="auto">Format: <code>CONCAT('ZoneID + UTM', fieldValue)</code>, concatenation to ensure uniqeness over different zones.</li>
<li dir="auto">Applies to ID fields and reference destination IDs to maintain relations in the destination</li>
</ul>
<p dir="auto"><strong>4. Handle Type Conversions</strong></p>
<ul>
<li dir="auto">Uses <code>fn_ExtractDigitsAsFloat()</code> for string-to-numeric conversions</li>
<li dir="auto">Converts between incompatible field types</li>
</ul>
<p dir="auto"><strong>5. Add System Fields</strong></p>
<ul>
<li dir="auto"><strong>OBJECTID</strong>: Generates sequential IDs starting from max existing + 1</li>
<li dir="auto"><strong>OPAZZoneID</strong>: Adds zone identifier</li>
<li dir="auto"><strong>RowHash</strong>: Placeholder for change detection hash</li>
<li dir="auto"><strong>sourceEntityGroup</strong>: Adds source entity group identifier</li>
</ul>
<p dir="auto"><strong>6. Finalize Field Mapping</strong></p>
<ul>
<li dir="auto">Adds <code>AS</code> aliases to all field expressions</li>
<li dir="auto">Creates complete SELECT statement from transformed fields</li>
</ul>
<h4 data-heading="2 Create Final Source Dataset" dir="auto">2 Create Final Source Dataset</h4>
<ul>
<li dir="auto">Executes dynamic SQL to create <code>##sourceData</code> temp table</li>
<li dir="auto">Applies all transformations in a single SELECT INTO operation</li>
</ul>
<h4 data-heading="3. Calculate Row Hash" dir="auto">3. Calculate Row Hash</h4>
<ul>
<li dir="auto">Generates SHA2_256 hash from all fields (excluding Shape, OBJECTID, GlobalID, RowHash)</li>
<li dir="auto">Concatenates all field values as strings</li>
<li dir="auto">Used for change detection by comparing source vs destination hashes</li>
<li dir="auto">The fields order during concatenation is important to ensure <code>RowHash</code> value consistency over  <code>SP_ETL_FC_Sync_Entity</code> and <code>SP_ETL_SC_Sync_Entity</code></li>
</ul>
<h3 data-heading="**Phase 4: Data Synchronization**" dir="auto"><strong>Phase 4: Data Synchronization</strong></h3>
<h4 data-heading="1. Archive Changed/Deleted Records" dir="auto">1. Archive Changed/Deleted Records</h4>
<ul>
<li dir="auto">Identifies destination rows that no longer match source data</li>
<li dir="auto">Criteria for archiving:
<ul>
<li dir="auto">RowHash differs OR Shape geometry differs</li>
<li dir="auto">Matching OPAZZoneID and sourceEntityGroup</li>
</ul>
</li>
<li dir="auto">Inserts archived rows into <code>{DestEntity}_Archive</code> table</li>
<li dir="auto">Preserves historical data before deletion</li>
</ul>
<h4 data-heading="2. Delete Obsolete Records" dir="auto">2. Delete Obsolete Records</h4>
<ul>
<li dir="auto">Removes destination rows that don't exist in source</li>
<li dir="auto">Uses same criteria as archival:
<ul>
<li dir="auto">No matching RowHash in source</li>
<li dir="auto">No matching Shape geometry</li>
<li dir="auto">Filters by OPAZZoneID and sourceEntityGroup</li>
</ul>
</li>
<li dir="auto">Ensures only relevant zone/group data is affected</li>
</ul>
<h4 data-heading="3. Insert New Records" dir="auto">3. Insert New Records</h4>
<ul>
<li dir="auto">Inserts rows from source that don't exist in destination</li>
<li dir="auto">Identifies new records by RowHash not present in destination</li>
<li dir="auto">Filters by OPAZZoneID and sourceEntityGroup</li>
<li dir="auto">Includes all transformed and calculated fields</li>
</ul>
<h4 data-heading="4. Validate Coded Value Mappings" dir="auto">4. Validate Coded Value Mappings</h4>
<ul>
<li dir="auto">Checks for unmapped values (represented as -1)</li>
<li dir="auto">Iterates through all coded value fields</li>
<li dir="auto">Generates warning message listing any unmapped fields</li>
<li dir="auto">Helps identify missing domain mappings</li>
</ul>
<h3 data-heading="**Phase 5: Logging &amp; Cleanup**" dir="auto"><strong>Phase 5: Logging &amp; Cleanup</strong></h3>
<h4 data-heading="Success Logging" dir="auto">Success Logging</h4>
<ul>
<li dir="auto">Inserts execution record into <code>ETL_Logs</code> table</li>
<li dir="auto">Captures:
<ul>
<li dir="auto">All dynamic SQL statements (SELECT, FROM, RowHash, DELETE, INSERT)</li>
<li dir="auto">Success status</li>
<li dir="auto">Unmapped value warnings</li>
</ul>
</li>
</ul>
<h4 data-heading="Error Handling" dir="auto">Error Handling</h4>
<ul>
<li dir="auto">Wraps entire process in TRY-CATCH with transaction</li>
<li dir="auto">On error:
<ul>
<li dir="auto">Rolls back all changes</li>
<li dir="auto">Logs error details (message, severity, state, line number)</li>
<li dir="auto">Records failed SQL statements (until failure) for debugging</li>
</ul>
</li>
</ul>
<h2 data-heading="Usage Example" dir="auto">Usage Example</h2>
<pre class="language-sql"><code class="language-sql is-loaded"><span class="token keyword">EXEC</span> <span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>SP_ETL_FC_Sync_Entity<span class="token punctuation">]</span>
    <span class="token variable">@SourceDB</span> <span class="token operator">=</span> <span class="token string">'Special Economic Zone at Duqm'</span><span class="token punctuation">,</span>
    <span class="token variable">@SourceEntityGroup</span> <span class="token operator">=</span> <span class="token string">'Plot'</span><span class="token punctuation">,</span>
    <span class="token variable">@DestEntity</span> <span class="token operator">=</span> <span class="token string">'cpPlot40'</span><span class="token punctuation">,</span>
    <span class="token variable">@JobID</span> <span class="token operator">=</span> <span class="token number">12345</span><span class="token punctuation">,</span>
    <span class="token variable">@LinkedServerName</span> <span class="token operator">=</span> <span class="token string">'SQLDBGISCLUSTER\SQLDBGIS,1434'</span><span class="token punctuation">,</span>
    <span class="token variable">@LinkedServerSourceDB</span> <span class="token operator">=</span> <span class="token string">'SEZAD2016'</span><span class="token punctuation">;</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path><style>
:root {
  --default-font: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Microsoft YaHei Light", sans-serif;
  --font-monospace: 'Source Code Pro', monospace;
  --background-primary: #ffffff;
  --background-modifier-border: #ddd;
  --text-accent: #705dcf;
  --text-accent-hover: #7a6ae6;
  --text-normal: #2e3338;
  --background-secondary: #f2f3f5;
  --background-secondary-alt: #e3e5e8;
  --text-muted: #888888;
}</style>"<marker id="mermaid_arrowhead" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker>"</svg></button></pre>
<h2 data-heading="Output" dir="auto">Output</h2>
<ul>
<li dir="auto">Prints unmapped value warnings to console</li>
<li dir="auto">Returns execution status in <code>ETL_Logs</code> table</li>
<li dir="auto">Updates destination entity with synchronized data</li>
<li dir="auto">Archives changed/deleted records</li>
</ul>
<h3 data-heading="**`SP_ETL_SC_Sync_Entity`**" dir="auto"><strong><code>SP_ETL_SC_Sync_Entity</code></strong></h3>
<h2 data-heading="Overview" dir="auto">Overview</h2>
<p dir="auto"><code>SP_ETL_SC_Sync_Entity</code> is a Slow Change ETL stored procedure that synchronizes spatial entity data from a local backup source database to the OMAP destination database. It includes validation checks, handles field mappings different cases, and performs hash-based change detection for incremental updates. Unlike the Fast Change procedure, this operates on local database copies rather than linked servers.</p>
<h2 data-heading="Purpose" dir="auto">Purpose</h2>
<p dir="auto">This procedure performs full data synchronization for entities that change infrequently, with extensive pre-validation to ensure data integrity before any modifications occur. </p>
<h2 data-heading="Parameters" dir="auto">Parameters</h2>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>@SourceDB</code></td>
<td>NVARCHAR(128)</td>
<td>Source database identifier used for mapping lookups</td>
</tr>
<tr>
<td><code>@SourceEntityGroup</code></td>
<td>NVARCHAR(255)</td>
<td>Logical grouping of related source entities/tables</td>
</tr>
<tr>
<td><code>@DestEntity</code></td>
<td>NVARCHAR(128)</td>
<td>Target entity/table name in the destination database</td>
</tr>
<tr>
<td><code>@JobID</code></td>
<td>BIGINT</td>
<td>Unique identifier for the ETL job execution</td>
</tr>
</tbody>
</table>
<h2 data-heading="Process Flow" dir="auto">Process Flow</h2>
<h3 data-heading="**Phase 1:  Validation (9 Steps)**" dir="auto"><strong>Phase 1:  Validation (9 Steps)</strong></h3>
<h4 data-heading="1. Verify Mapping Configuration Exists" dir="auto">1. Verify Mapping Configuration Exists</h4>
<ul>
<li dir="auto">Checks if mapping exists in <code>FieldsMapping</code> table for the specified source DB, entity group, and destination entity</li>
<li dir="auto"><strong>Fails early</strong> if no mapping configuration is found</li>
<li dir="auto">Ensures the ETL job has valid metadata to proceed</li>
</ul>
<h4 data-heading="2. Validate Source Tables Existence" dir="auto">2. Validate Source Tables Existence</h4>
<ul>
<li dir="auto">Extracts all source entities involved in the synchronization from <code>FieldsMapping</code></li>
<li dir="auto">Creates <code>#sourceTables</code> temporary table with:
<ul>
<li dir="auto">Source entity names</li>
<li dir="auto">Primary key relationships</li>
<li dir="auto">Foreign key relationships</li>
</ul>
</li>
<li dir="auto">Removes duplicate entries for tables without primary keys</li>
<li dir="auto"><strong>Fails</strong> if no source tables are identified</li>
<li dir="auto">Identifies the primary table (the one without a primary key reference)</li>
</ul>
<h4 data-heading="3. Check for Duplicate Field Mappings" dir="auto">3. Check for Duplicate Field Mappings</h4>
<ul>
<li dir="auto">Identifies any destination fields that are mapped from multiple source fields</li>
<li dir="auto">Creates <code>#DuplicateFields</code> temporary table</li>
<li dir="auto">Aggregates duplicate fields into a comma-separated error message</li>
<li dir="auto"><strong>Fails</strong> if duplicate mappings are detected</li>
<li dir="auto">Prevents data conflicts and ambiguous field assignments</li>
</ul>
<h4 data-heading="4. Verify Destination Entity Exists" dir="auto">4. Verify Destination Entity Exists</h4>
<ul>
<li dir="auto">Checks physical existence of destination table in OMAP database</li>
<li dir="auto">Validates table exists in the correct schema</li>
<li dir="auto"><strong>Fails</strong> if destination table is not found</li>
<li dir="auto">Ensures target table is ready to receive data</li>
</ul>
<h4 data-heading="5. Validate Destination Fields Exist" dir="auto">5. Validate Destination Fields Exist</h4>
<ul>
<li dir="auto">Compares all mapped destination fields against actual table columns</li>
<li dir="auto">Creates <code>#EntityFieldsMapping</code> temporary table containing:
<ul>
<li dir="auto">Source and destination field names</li>
<li dir="auto">Field types and data types</li>
<li dir="auto">Coded value indicators</li>
<li dir="auto">Reference relationships</li>
<li dir="auto">UTM zone information</li>
</ul>
</li>
<li dir="auto">Identifies missing destination fields</li>
<li dir="auto"><strong>Fails</strong> if any mapped fields don't exist in destination table</li>
<li dir="auto">Prevents runtime errors during INSERT operations</li>
</ul>
<h4 data-heading="6. Check for Empty or Null Mappings" dir="auto">6. Check for Empty or Null Mappings</h4>
<ul>
<li dir="auto">Validates that all field mappings have non-null, non-empty source and destination fields</li>
<li dir="auto"><strong>Fails</strong> if any mapping has missing field names</li>
<li dir="auto">Ensures data integrity of mapping configuration</li>
</ul>
<h4 data-heading="7. Validate WHERE Condition Uniqueness" dir="auto">7. Validate WHERE Condition Uniqueness</h4>
<ul>
<li dir="auto">Extracts all WHERE conditions from field mappings</li>
<li dir="auto">Creates <code>#whereConditions</code> temporary table</li>
<li dir="auto"><strong>Fails</strong> if multiple different WHERE conditions are defined</li>
<li dir="auto">Ensures consistent filtering logic across the entity group</li>
<li dir="auto">Sets <code>@whereCondition</code> variable for later use</li>
</ul>
<h4 data-heading="8. Check for Multiple Primary Tables" dir="auto">8. Check for Multiple Primary Tables</h4>
<ul>
<li dir="auto">Validates that only one primary table exists in the source entity group</li>
<li dir="auto"><strong>Fails</strong> if multiple primary tables (<code>relatedPrimaryEntity</code>) are detected</li>
<li dir="auto">Prevents ambiguous JOIN relationships</li>
<li dir="auto">Lists conflicting primary tables in error message</li>
</ul>
<h4 data-heading="9. Confirm Primary Table is Defined" dir="auto">9. Confirm Primary Table is Defined</h4>
<ul>
<li dir="auto">Ensures at least one table without a primary key reference exists</li>
<li dir="auto">Sets <code>@PrimaryTable</code> variable</li>
<li dir="auto"><strong>Fails</strong> if no primary table is identified</li>
<li dir="auto">Prevents orphaned JOIN chains</li>
</ul>
<h3 data-heading="**Phase 2: Destination Table Preparation**" dir="auto"><strong>Phase 2: Destination Table Preparation</strong></h3>
<h4 data-heading="1. Add Required System Columns" dir="auto">1. Add Required System Columns</h4>
<p dir="auto">Dynamically alters the destination table to add tracking columns if they don't exist:</p>
<p dir="auto"><strong>Columns Added:</strong></p>
<ul>
<li dir="auto"><strong>RowHash</strong> (VARCHAR(64)): SHA2_256 hash for change detection</li>
<li dir="auto"><strong>source_objectid</strong> (INT): Original OBJECTID from source</li>
<li dir="auto"><strong>source_globalID</strong> (UNIQUEIDENTIFIER): Original GlobalID from source</li>
<li dir="auto"><strong>sourceEntityGroup</strong> (NVARCHAR(255)): Source entity group identifier</li>
<li dir="auto"><strong>LastSyncAt</strong> (DATETIME2): Timestamp of last synchronization (default: current date/time)</li>
</ul>
<h4 data-heading="2. Add GlobalID Column" dir="auto">2. Add GlobalID Column</h4>
<ul>
<li dir="auto">Checks for GlobalID column existence</li>
<li dir="auto">Adds GlobalID (UNIQUEIDENTIFIER) if missing</li>
<li dir="auto">Ensures compatibility with ArcGIS enterprise geodatabase standards</li>
</ul>
<h3 data-heading="**Phase 3: Data Extraction &amp; Transformation**" dir="auto"><strong>Phase 3: Data Extraction &amp; Transformation</strong></h3>
<h4 data-heading="1. Build Dynamic SELECT Statement" dir="auto">1. Build Dynamic SELECT Statement</h4>
<p dir="auto"><strong>Step 1: Prefix Fields with Table Names</strong></p>
<ul>
<li dir="auto">Updates <code>sourceFieldFullName</code> to include table prefix</li>
<li dir="auto">Format: <code>TableName.FieldName</code></li>
<li dir="auto">Skips fields already in formula format (containing parentheses)</li>
</ul>
<p dir="auto"><strong>Step 2: Handle Coded Domain Values</strong></p>
<ul>
<li dir="auto">Applies <code>fn_Get_Mapped_Field_Value()</code> function for fields with domains</li>
<li dir="auto">Maps source coded values to destination domain values</li>
<li dir="auto">Handles subtype-dependent domains using <code>sourceSubtypeField</code></li>
<li dir="auto">Example: Status codes (1='Active', 2='Inactive') mapped to destination domains</li>
</ul>
<p dir="auto"><strong>Step 3: Generate ID and Reference Fields</strong></p>
<ul>
<li dir="auto">Concatenates OPAZ Zone ID + UTM Zone + field value</li>
<li dir="auto">Format: <code>CONCAT('ZoneID', fieldValue)</code></li>
<li dir="auto">Applies to:
<ul>
<li dir="auto">ID fields (primary identifiers)</li>
<li dir="auto">Fields referencing destination IDs (foreign keys)</li>
</ul>
</li>
<li dir="auto">Creates globally unique identifiers across zones</li>
</ul>
<p dir="auto"><strong>Step 4: Handle Data Type Conversions</strong></p>
<ul>
<li dir="auto">Uses <code>fn_ExtractDigitsAsFloat()</code> for string-to-numeric conversions</li>
<li dir="auto">Converts between incompatible field types:
<ul>
<li dir="auto">String → Integer, SmallInteger, Double, BigInteger</li>
</ul>
</li>
<li dir="auto">Extracts numeric values from mixed-content strings</li>
</ul>
<p dir="auto"><strong>Step 5: Add Shape Geometry Field</strong></p>
<ul>
<li dir="auto">Checks if Shape field exists in both source and destination</li>
<li dir="auto">Verifies column existence in:
<ul>
<li dir="auto">Destination table (OMAP database)</li>
<li dir="auto">Primary source table (SDE database)</li>
</ul>
</li>
<li dir="auto">Adds Shape field to mapping if present in both</li>
<li dir="auto">Sets <code>@ShapeFieldExists</code> flag for later use</li>
</ul>
<p dir="auto"><strong>Step 6: Add GlobalID Field</strong></p>
<ul>
<li dir="auto">Checks for GlobalID existence in source primary table</li>
<li dir="auto">If exists:
<ul>
<li dir="auto">Maps source GlobalID to <code>source_globalID</code> in destination</li>
<li dir="auto">Maps source GlobalID to destination <code>GlobalID</code> field (if not already mapped)</li>
</ul>
</li>
<li dir="auto">If missing:
<ul>
<li dir="auto">Generates new GUID using <code>NEWID()</code> function</li>
</ul>
</li>
</ul>
<p dir="auto"><strong>Step 7: Add OBJECTID Field</strong></p>
<ul>
<li dir="auto">Retrieves maximum existing OBJECTID from destination table</li>
<li dir="auto">Generates sequential IDs: <code>@MaxObjectID + ROW_NUMBER()</code></li>
<li dir="auto">Maps source OBJECTID to <code>source_objectID</code> (if not already mapped)</li>
<li dir="auto">Ensures unique OBJECTID values in destination</li>
</ul>
<p dir="auto"><strong>Step 8: Add OPAZZoneID Field</strong></p>
<ul>
<li dir="auto">Inserts zone identifier from metadata</li>
<li dir="auto">Enables zone-based data partitioning</li>
</ul>
<p dir="auto"><strong>Step 9: Add RowHash Placeholder</strong></p>
<ul>
<li dir="auto">Inserts NULL placeholder for hash calculation</li>
<li dir="auto">Will be populated in step 11</li>
</ul>
<p dir="auto"><strong>Step 10: Add Source Entity Group</strong></p>
<ul>
<li dir="auto">Inserts source entity group identifier</li>
<li dir="auto">Enables filtering by entity group during sync</li>
</ul>
<p dir="auto"><strong>Step 11: Apply Default Aliasing</strong></p>
<ul>
<li dir="auto">Adds <code>AS destination_field</code> to all source field expressions</li>
<li dir="auto">Completes the SELECT clause construction</li>
</ul>
<h4 data-heading="2. Build Dynamic FROM Clause with JOINs" dir="auto">2. Build Dynamic FROM Clause with JOINs</h4>
<p dir="auto"><strong>Step 1: Construct FROM Statement</strong></p>
<ul>
<li dir="auto">Creates base FROM clause with primary table</li>
<li dir="auto">Adds LEFT JOINs for related tables using primary/foreign key relationships</li>
<li dir="auto">Format:</li>
</ul>
<pre class="language-sql"><code class="language-sql is-loaded">  <span class="token keyword">FROM</span> <span class="token punctuation">[</span>SDE_DB<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token keyword">Schema</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>PrimaryTable<span class="token punctuation">]</span>
  <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">[</span>SDE_DB<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token keyword">Schema</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>RelatedTable<span class="token punctuation">]</span> 
    <span class="token keyword">ON</span> <span class="token punctuation">[</span>PrimaryTable<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>PK<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>RelatedTable<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>FK<span class="token punctuation">]</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path><style>
:root {
  --default-font: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Microsoft YaHei Light", sans-serif;
  --font-monospace: 'Source Code Pro', monospace;
  --background-primary: #ffffff;
  --background-modifier-border: #ddd;
  --text-accent: #705dcf;
  --text-accent-hover: #7a6ae6;
  --text-normal: #2e3338;
  --background-secondary: #f2f3f5;
  --background-secondary-alt: #e3e5e8;
  --text-muted: #888888;
}</style>"<marker id="mermaid_arrowhead" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker>"</svg></button></pre>
<p dir="auto"><strong>Step 2: Execute Data Extraction</strong></p>
<ul>
<li dir="auto">Combines SELECT and FROM clauses</li>
<li dir="auto">Adds WHERE condition if defined in validation phase</li>
<li dir="auto">Applies entity name suffix (e.g., <code>_evw</code> for enterprise views)</li>
<li dir="auto">Replaces all table references with suffixed versions</li>
<li dir="auto">Creates <code>##sourceData</code> global temporary table with transformed data</li>
<li dir="auto">Executes dynamic SQL to populate temp table</li>
</ul>
<h4 data-heading="3. Calculate Row Hash for Change Detection" dir="auto">3. Calculate Row Hash for Change Detection</h4>
<ul>
<li dir="auto">Generates SHA2_256 hash from all relevant fields</li>
<li dir="auto">Concatenates field values (excluding: RowHash, Shape, OBJECTID, GlobalID)</li>
<li dir="auto">Converts all values to NVARCHAR(1000), uses empty string for NULLs</li>
<li dir="auto">Orders fields consistently for reproducible hashes</li>
<li dir="auto">Updates RowHash column in <code>##sourceData</code></li>
<li dir="auto">Enables efficient change detection by comparing hashes</li>
</ul>
<h3 data-heading="**Phase 4: Data Synchronization**" dir="auto"><strong>Phase 4: Data Synchronization</strong></h3>
<h4 data-heading="1. Delete Obsolete Records" dir="auto">1. Delete Obsolete Records</h4>
<p dir="auto"><strong>Without Shape Field:</strong></p>
<ul>
<li dir="auto">Simple hash comparison</li>
<li dir="auto">Deletes destination rows where RowHash doesn't exist in source</li>
<li dir="auto">Filters by OPAZZoneID and sourceEntityGroup</li>
</ul>
<p dir="auto"><strong>With Shape Field:</strong></p>
<ul>
<li dir="auto">Complex comparison with geometry validation</li>
<li dir="auto">Performs LEFT JOIN between destination and source</li>
<li dir="auto">Matches on both:
<ul>
<li dir="auto">RowHash (with collation: Arabic_100_CI_AS)</li>
<li dir="auto">Shape geometry equality (<code>STEquals()</code> = 1)</li>
</ul>
</li>
<li dir="auto">Deletes rows where no match is found</li>
<li dir="auto">Filters by OPAZZoneID and sourceEntityGroup</li>
<li dir="auto">Handles spatial data changes more precisely</li>
</ul>
<h4 data-heading="2. Insert New Records" dir="auto">2. Insert New Records</h4>
<ul>
<li dir="auto">Identifies new rows by comparing RowHash values</li>
<li dir="auto">Selects all rows from <code>##sourceData</code> where RowHash doesn't exist in destination</li>
<li dir="auto">Filters by OPAZZoneID and sourceEntityGroup</li>
<li dir="auto">Inserts all mapped fields including:
<ul>
<li dir="auto">Transformed data fields</li>
<li dir="auto">Generated system fields (OBJECTID, GlobalID, RowHash)</li>
<li dir="auto">Metadata fields (OPAZZoneID, sourceEntityGroup)</li>
</ul>
</li>
</ul>
<h4 data-heading="3. Validate Coded Value Mappings" dir="auto">3. Validate Coded Value Mappings</h4>
<ul>
<li dir="auto">Iterates through all fields with coded values using CURSOR</li>
<li dir="auto">Checks destination table for any <code>-1</code> values (unmapped indicator)</li>
<li dir="auto">Filters by OPAZZoneID and sourceEntityGroup</li>
<li dir="auto">Builds warning message listing:
<ul>
<li dir="auto">Source field name</li>
<li dir="auto">Destination field name</li>
</ul>
</li>
<li dir="auto">Prints warning message to console</li>
<li dir="auto">Helps identify missing domain mappings in <code>ValuesMapping</code> table</li>
</ul>
<hr>
<h3 data-heading="**Phase 5: Logging &amp; Cleanup**" dir="auto"><strong>Phase 5: Logging &amp; Cleanup</strong></h3>
<h4 data-heading="Success Path" dir="auto">Success Path</h4>
<ul>
<li dir="auto">Inserts execution record into <code>ETL_Logs</code> table</li>
<li dir="auto">Captures:
<ul>
<li dir="auto">All dynamic SQL statements (SELECT, FROM, RowHash, DELETE, INSERT)</li>
<li dir="auto">Success status</li>
<li dir="auto">Unmapped value warnings (if any)</li>
</ul>
</li>
<li dir="auto">Drops temporary tables:
<ul>
<li dir="auto"><code>#EntityFieldsMapping</code></li>
<li dir="auto"><code>#sourceTables</code></li>
<li dir="auto"><code>##sourceData</code></li>
</ul>
</li>
<li dir="auto">Commits transaction</li>
</ul>
<h4 data-heading="Error Handling" dir="auto">Error Handling</h4>
<ul>
<li dir="auto">Wraps entire procedure in TRY-CATCH with transaction</li>
<li dir="auto">On error:
<ul>
<li dir="auto">Rolls back all changes</li>
<li dir="auto">Captures error details:
<ul>
<li dir="auto">Error message</li>
<li dir="auto">Error severity</li>
<li dir="auto">Error state</li>
<li dir="auto">Error line number</li>
</ul>
</li>
<li dir="auto">Logs error to <code>ETL_Logs</code> table with:
<ul>
<li dir="auto">All constructed SQL statements (for debugging)</li>
<li dir="auto">Failure status</li>
</ul>
</li>
<li dir="auto">Prints error message and line number</li>
<li dir="auto">Returns control to caller</li>
</ul>
</li>
</ul>
<h2 data-heading="Usage Example" dir="auto">Usage Example</h2>
<pre class="language-sql"><code class="language-sql is-loaded"><span class="token keyword">EXEC</span> <span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>SP_ETL_SC_Sync_Entity<span class="token punctuation">]</span>
    <span class="token variable">@SourceDB</span> <span class="token operator">=</span> <span class="token string">'Special Economic Zone at Duqm'</span><span class="token punctuation">,</span>
    <span class="token variable">@SourceEntityGroup</span> <span class="token operator">=</span> <span class="token string">'Plot'</span><span class="token punctuation">,</span>
    <span class="token variable">@DestEntity</span> <span class="token operator">=</span> <span class="token string">'cpPlot40'</span><span class="token punctuation">,</span>
    <span class="token variable">@JobID</span> <span class="token operator">=</span> <span class="token number">12345</span><span class="token punctuation">;</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path><style>
:root {
  --default-font: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Microsoft YaHei Light", sans-serif;
  --font-monospace: 'Source Code Pro', monospace;
  --background-primary: #ffffff;
  --background-modifier-border: #ddd;
  --text-accent: #705dcf;
  --text-accent-hover: #7a6ae6;
  --text-normal: #2e3338;
  --background-secondary: #f2f3f5;
  --background-secondary-alt: #e3e5e8;
  --text-muted: #888888;
}</style>"<marker id="mermaid_arrowhead" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker>"</svg></button></pre>
<h2 data-heading="Output" dir="auto">Output</h2>
<ul>
<li dir="auto">Prints validation results for each step</li>
<li dir="auto">Prints unmapped value warnings (if any)</li>
<li dir="auto">Returns execution status in <code>ETL_Logs</code> table</li>
<li dir="auto">Updates destination entity with synchronized data</li>
</ul>
<hr>
<h4 data-heading="**`SP_ETL_Mapping_Tables_Preparation`**" dir="auto"><strong><code>SP_ETL_Mapping_Tables_Preparation</code></strong></h4>
<h2 data-heading="Overview" dir="auto">Overview</h2>
<p dir="auto"><strong>SP_ETL_Mapping_Tables_Preparation</strong>&nbsp;is a stored procedure that prepares mapping tables for data transformation processes. It processes source-to-destination field mappings, value mappings, and maintains backup history.</p>
<h2 data-heading="Purpose" dir="auto">Purpose</h2>
<p dir="auto">This procedure transforms raw mapping data from source tables (<code>FIELDS</code>,&nbsp;<code>Mappings</code>,&nbsp;<code>domains</code>,&nbsp;<code>objectClasses</code>) into structured mapping tables (<code>fieldsMapping</code>,&nbsp;<code>valuesMapping</code>) used for ETL processes, with additional business logic for spatial references and entity grouping.</p>
<h2 data-heading="Process Flow" dir="auto">Process Flow</h2>
<h3 data-heading="**Phase 1: Fields Mapping Preparation**" dir="auto"><strong>Phase 1: Fields Mapping Preparation</strong></h3>
<p dir="auto"><strong>Source Table</strong>:&nbsp;<code>dbo.FIELDS</code><br>
<strong>Destination Table</strong>:&nbsp;<code>dbo.fieldsMapping</code></p>
<h4 data-heading="Key Transformations:" dir="auto">Key Transformations:</h4>
<ul>
<li dir="auto"><strong>Data Cleaning</strong>: Trims whitespace characters (CHAR(10), CHAR(13), CHAR(9)) from all text fields</li>
<li dir="auto"><strong>Filtering</strong>: Only includes records where:
<ul>
<li dir="auto"><code>is_In_Design = 'Yes'</code>&nbsp;OR</li>
<li dir="auto"><code>RelationshipOriginPrimaryKey IS NOT NULL</code><br>
</li>
</ul>
</li>
<li dir="auto"><strong>Column Mapping</strong>:
<ul>
<li dir="auto">Relationship fields (relatedPrimaryKey, relatedPrimaryEntity)</li>
<li dir="auto">Additional metadata fields:
<ul>
<li dir="auto"><strong>hasCodedValue</strong>: to identify if there is value mapping for this field or not.</li>
<li dir="auto"><strong>foreignKey</strong>: to specify the table foreign key if any.</li>
<li dir="auto"><strong>hasArchive</strong>: for future features (Not considered in this version yet).</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 data-heading="Special Handling:" dir="auto">Special Handling:</h4>
<ul>
<li dir="auto">Replaces 'NA', 'N/A' values with NULL in dataset fields</li>
<li dir="auto">Handles table creation if not exists, otherwise truncates and repopulates</li>
</ul>
<h3 data-heading="**Phase 2: Spatial Reference Assignment**" dir="auto"><strong>Phase 2: Spatial Reference Assignment</strong></h3>
<p dir="auto">Sets&nbsp;<code>source_SR_WKID</code>&nbsp;based on source database:</p>
<ul>
<li dir="auto"><strong>32639</strong>: Salalah Free Zone, Industrial Estates (MADAYN) with datasets ending in '_39'</li>
<li dir="auto"><strong>32640</strong>: Sohar Free Zone, Special Economic Zone at Duqm, Industrial Estates (MADAYN) with datasets ending in '_40'</li>
</ul>
<h3 data-heading="**Phase 3: Destination Entity Zone Suffixing" dir="auto">**Phase 3: Destination Entity Zone Suffixing</h3>
<p dir="auto">Appends zone prefix to destination entities to match the destination database schema:</p>
<ul>
<li dir="auto"><strong>Zone 39</strong>: Appends '39' to&nbsp;<code>destEntity</code>&nbsp;(except 'cpPlot<strong>ATTACH' becomes 'cpPlot39</strong>ATTACH')</li>
<li dir="auto"><strong>Zone 40</strong>: Appends '40' to&nbsp;<code>destEntity</code>&nbsp;(except 'cpPlot<strong>ATTACH' becomes 'cpPlot40</strong>ATTACH')</li>
</ul>
<h3 data-heading="**Phase 4: Values Mapping Preparation" dir="auto">**Phase 4: Values Mapping Preparation</h3>
<p dir="auto"><strong>Source Tables</strong>:&nbsp;<code>dbo.Mappings</code>,&nbsp;<code>dbo.domains</code>,&nbsp;<code>dbo.objectClasses</code><br>
<strong>Destination Table</strong>:&nbsp;<code>dbo.valuesMapping</code></p>
<h4 data-heading="Three Data Sources:" dir="auto">Three Data Sources:</h4>
<ol>
<li dir="auto"><strong>Main Mappings</strong>: Direct field value mappings from&nbsp;<code>Mappings</code>&nbsp;table</li>
<li dir="auto"><strong>Domain Values</strong>: Coded value domains from&nbsp;<code>domains</code>&nbsp;table (joined with fieldsMapping to populate other fields in fieldsMapping)</li>
<li dir="auto"><strong>Subtype Mappings</strong>: Subtype code mappings from&nbsp;<code>objectClasses</code>&nbsp;table</li>
</ol>
<h3 data-heading="**Phase 5: Relationship and Grouping Logic**" dir="auto"><strong>Phase 5: Relationship and Grouping Logic</strong></h3>
<ul>
<li dir="auto"><strong>Foreign Key Identification</strong>: Sets&nbsp;<code>foreignKey = sourceField</code>&nbsp;where&nbsp;<code>relatedPrimaryKey IS NOT NULL</code></li>
<li dir="auto"><strong>Entity Grouping</strong>:
<ul>
<li dir="auto">Initial grouping:&nbsp;<code>sourceEntityGroup = sourceEntity</code></li>
<li dir="auto">Updates with related primary entities where relationships exist</li>
<li dir="auto">Custom grouping via&nbsp;<code>CustomSourceEntityGroup</code>&nbsp;concatenation when grouping is provided from the mapping sheet.</li>
</ul>
</li>
<li dir="auto"><strong>Primary Key Cleanup</strong>: Nullifies relationship fields when source entity is the primary table</li>
</ul>
<h3 data-heading="**Phase 6: Define the fields with value mapping**" dir="auto"><strong>Phase 6: Define the fields with value mapping</strong></h3>
<p dir="auto">Set <code>hasCodedValue = 1</code> where the field has mapping in the <code>valuesMapping</code> table </p>
<h3 data-heading="**Phase 7: Domain Tables Creation**" dir="auto"><strong>Phase 7: Domain Tables Creation</strong></h3>
<p dir="auto">Creates distinct value domains for:</p>
<ul>
<li dir="auto"><code>DomainSourceDB</code>: Unique source databases</li>
<li dir="auto"><code>DomainDestEntity</code>: Unique destination entities</li>
<li dir="auto"><code>DomainSourceEntityGroup</code>: Unique source entity group.<br>
To be used in ETL tool interface.</li>
</ul>
<h3 data-heading="**Phase 8: Backup Management" dir="auto">**Phase 8: Backup Management</h3>
<ul>
<li dir="auto">Takes backup of the uploaded version into <code>fieldsMapping_backups</code>&nbsp;and&nbsp;<code>valuesMapping_backups</code></li>
<li dir="auto">Deletes unnecessary backups of&nbsp;<code>fieldsMapping</code>&nbsp;and&nbsp;<code>valuesMapping</code></li>
<li dir="auto">Keeps only the last 10 backups using DENSE_RANK()</li>
<li dir="auto">Includes timestamp for backup identification</li>
</ul>
<hr>
    </body>
</html>